(self.webpackJsonp__wix_thunderbolt_app = self.webpackJsonp__wix_thunderbolt_app || []).push([
    [4600], {
        61916: function(e) {
            "use strict";

            function t(e) {
                return t = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e) {
                    return typeof e
                } : function(e) {
                    return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e
                }, t(e)
            }
            var r = "User",
                i = "Error",
                n = "EDM",
                s = function(e, r) {
                    e && "object" === t(e) && (e.errorGroup = r)
                };
            e.exports = {
                markUserError: function(e) {
                    return s(e, r)
                },
                isUserError: function(e) {
                    return e && e.errorGroup === r
                },
                markAppError: function(e) {
                    return s(e, i)
                },
                isAppError: function(e) {
                    return e && e.errorGroup === i
                },
                markEdmError: function(e) {
                    return s(e, n)
                },
                isEdmError: function(e) {
                    return e && e.errorGroup === n
                },
                markError: s,
                isMarked: function(e) {
                    return !!e && void 0 !== e.errorGroup
                },
                USER_ERROR_GROUP: r,
                APP_ERROR_GROUP: i,
                EDM_ERROR_GROUP: n,
                UNKNOWN_ERROR_GROUP: "Unknown"
            }
        },
        50470: function(e, t, r) {
            "use strict";

            function i(e) {
                return i = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e) {
                    return typeof e
                } : function(e) {
                    return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e
                }, i(e)
            }

            function n(e, t) {
                for (var r = 0; r < t.length; r++) {
                    var i = t[r];
                    i.enumerable = i.enumerable || !1, i.configurable = !0, "value" in i && (i.writable = !0), Object.defineProperty(e, i.key, i)
                }
            }

            function s(e, t) {
                return s = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function(e, t) {
                    return e.__proto__ = t, e
                }, s(e, t)
            }

            function a(e) {
                var t = function() {
                    if ("undefined" == typeof Reflect || !Reflect.construct) return !1;
                    if (Reflect.construct.sham) return !1;
                    if ("function" == typeof Proxy) return !0;
                    try {
                        return Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], (function() {}))), !0
                    } catch (e) {
                        return !1
                    }
                }();
                return function() {
                    var r, n = l(e);
                    if (t) {
                        var s = l(this).constructor;
                        r = Reflect.construct(n, arguments, s)
                    } else r = n.apply(this, arguments);
                    return function(e, t) {
                        if (t && ("object" === i(t) || "function" == typeof t)) return t;
                        if (void 0 !== t) throw new TypeError("Derived constructors may only return object or undefined");
                        return o(e)
                    }(this, r)
                }
            }

            function o(e) {
                if (void 0 === e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return e
            }

            function l(e) {
                return l = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function(e) {
                    return e.__proto__ || Object.getPrototypeOf(e)
                }, l(e)
            }
            var u = r(61916),
                c = function(e) {
                    ! function(e, t) {
                        if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function");
                        e.prototype = Object.create(t && t.prototype, {
                            constructor: {
                                value: e,
                                writable: !0,
                                configurable: !0
                            }
                        }), Object.defineProperty(e, "prototype", {
                            writable: !1
                        }), t && s(e, t)
                    }(c, e);
                    var t, r, i, l = a(c);

                    function c() {
                        var e;
                        ! function(e, t) {
                            if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                        }(this, c);
                        for (var t = arguments.length, r = new Array(t), i = 0; i < t; i++) r[i] = arguments[i];
                        return e = l.call.apply(l, [this].concat(r)), Error.captureStackTrace && Error.captureStackTrace(o(e), e.constructor), e.name = c.name, u.markUserError(o(e)), e
                    }
                    return t = c, r && n(t.prototype, r), i && n(t, i), Object.defineProperty(t, "prototype", {
                        writable: !1
                    }), t
                }(function(e) {
                    function t() {
                        var t = Reflect.construct(e, Array.from(arguments));
                        return Object.setPrototypeOf(t, Object.getPrototypeOf(this)), t
                    }
                    return t.prototype = Object.create(e.prototype, {
                        constructor: {
                            value: e,
                            enumerable: !1,
                            writable: !0,
                            configurable: !0
                        }
                    }), Object.setPrototypeOf ? Object.setPrototypeOf(t, e) : t.__proto__ = e, t
                }(Error));
            e.exports = {
                UserCodeError: c
            }
        },
        62673: function(e, t, r) {
            "use strict";

            function i(e, t) {
                var r = Object.keys(e);
                if (Object.getOwnPropertySymbols) {
                    var i = Object.getOwnPropertySymbols(e);
                    t && (i = i.filter((function(t) {
                        return Object.getOwnPropertyDescriptor(e, t).enumerable
                    }))), r.push.apply(r, i)
                }
                return r
            }

            function n(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var r = null != arguments[t] ? arguments[t] : {};
                    t % 2 ? i(Object(r), !0).forEach((function(t) {
                        s(e, t, r[t])
                    })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(r)) : i(Object(r)).forEach((function(t) {
                        Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(r, t))
                    }))
                }
                return e
            }

            function s(e, t, r) {
                return t in e ? Object.defineProperty(e, t, {
                    value: r,
                    enumerable: !0,
                    configurable: !0,
                    writable: !0
                }) : e[t] = r, e
            }
            var a = r(61916),
                o = r(50470);
            e.exports = n(n({}, o), a)
        },
        69012: function(e) {
            var t = Object.prototype.toString;
            e.exports = function(e) {
                var r = typeof e;
                return "undefined" === r ? "undefined" : null === e ? "null" : !0 === e || !1 === e || e instanceof Boolean ? "boolean" : "string" === r || e instanceof String ? "string" : "number" === r || e instanceof Number ? "number" : "function" === r || e instanceof Function ? void 0 !== e.constructor.name && "Generator" === e.constructor.name.slice(0, 9) ? "generatorfunction" : "function" : void 0 !== Array.isArray && Array.isArray(e) ? "array" : e instanceof RegExp ? "regexp" : e instanceof Date ? "date" : "[object RegExp]" === (r = t.call(e)) ? "regexp" : "[object Date]" === r ? "date" : "[object Arguments]" === r ? "arguments" : "[object Error]" === r ? "error" : "[object Promise]" === r ? "promise" : function(e) {
                    return e.constructor && "function" == typeof e.constructor.isBuffer && e.constructor.isBuffer(e)
                }(e) ? "buffer" : "[object Set]" === r ? "set" : "[object WeakSet]" === r ? "weakset" : "[object Map]" === r ? "map" : "[object WeakMap]" === r ? "weakmap" : "[object Symbol]" === r ? "symbol" : "[object Map Iterator]" === r ? "mapiterator" : "[object Set Iterator]" === r ? "setiterator" : "[object String Iterator]" === r ? "stringiterator" : "[object Array Iterator]" === r ? "arrayiterator" : "[object Int8Array]" === r ? "int8array" : "[object Uint8Array]" === r ? "uint8array" : "[object Uint8ClampedArray]" === r ? "uint8clampedarray" : "[object Int16Array]" === r ? "int16array" : "[object Uint16Array]" === r ? "uint16array" : "[object Int32Array]" === r ? "int32array" : "[object Uint32Array]" === r ? "uint32array" : "[object Float32Array]" === r ? "float32array" : "[object Float64Array]" === r ? "float64array" : "object"
            }
        },
        44704: function(e, t, r) {
            "use strict";
            r.r(t), r.d(t, {
                base64url: function() {
                    return w
                },
                clone: function() {
                    return g
                },
                extractForwardHeaders: function() {
                    return D
                },
                getSchemaName: function() {
                    return $
                },
                getSchemaNamespace: function() {
                    return O
                },
                isArray: function() {
                    return a
                },
                isBoolean: function() {
                    return u
                },
                isDate: function() {
                    return o
                },
                isFunction: function() {
                    return d
                },
                isNull: function() {
                    return m
                },
                isNumber: function() {
                    return l
                },
                isObject: function() {
                    return s
                },
                isString: function() {
                    return c
                },
                isUndefined: function() {
                    return p
                },
                parseDates: function() {
                    return N
                },
                parseEntityJson: function() {
                    return y
                },
                parseSchemaId: function() {
                    return j
                },
                serializeDates: function() {
                    return _
                },
                stringifyEntityJson: function() {
                    return I
                },
                toPlatformizedAggregate: function() {
                    return S
                },
                typeForDisplay: function() {
                    return h
                },
                validateHttpResponse: function() {
                    return E
                }
            });
            var i = r(83301),
                n = r.n(i);

            function s(e) {
                return "object" === n()(e)
            }

            function a(e) {
                return "array" === n()(e)
            }

            function o(e) {
                return "date" === n()(e)
            }

            function l(e) {
                return "number" === n()(e)
            }

            function u(e) {
                return "boolean" === n()(e)
            }

            function c(e) {
                return "string" === n()(e)
            }

            function d(e) {
                return "function" === n()(e)
            }

            function h(e) {
                return function(e) {
                    if (!c(e)) return e;
                    const t = e.slice(0, 1).toUpperCase(),
                        r = e.slice(1, e.length);
                    return t + r
                }(n()(e))
            }

            function p(e) {
                return "undefined" === n()(e)
            }

            function m(e) {
                return "null" === n()(e)
            }

            function g(e) {
                if (null == e || "object" != typeof e) return e;
                let t = null;
                if (o(e)) t = new Date(e.getTime());
                else {
                    t = e.constructor();
                    for (const r in e) t[r] = g(e[r])
                }
                return t
            }

            function f(e) {
                return "[object Date]" === Object.prototype.toString.call(e) && !isNaN(e.getTime())
            }
            const v = e => isNaN(e) && !isNaN(new Date(e).getDate());

            function y(e) {
                let t = null;
                return JSON.parse(e, (function(e, r) {
                    if ("$date" === e && v(r)) t = new Date(r);
                    else {
                        if ("$date" !== e) {
                            if (null !== t) {
                                const e = t;
                                return t = null, e
                            }
                            return r
                        }
                        t = {
                            $date: r
                        }
                    }
                }))
            }

            function N(e) {
                if ("object" != typeof e || f(e)) return e;
                const t = A(e);
                for (const e in t) t[e] && t[e].$date && v(t[e].$date) ? t[e] = new Date(t[e].$date) : "object" == typeof t[e] && null !== t[e] && (t[e] = N(t[e]));
                return t
            }

            function _(e) {
                if ("object" != typeof e || f(e)) return e;
                const t = A(e);
                for (const e in t) t[e] && f(t[e]) ? t[e] = b(t[e]) : "object" == typeof t[e] && null !== t[e] && (t[e] = _(t[e]));
                return t
            }

            function I(e) {
                return JSON.stringify(e, (function(e, t) {
                    return function(e, t, r) {
                        if (t && f(e[t])) return b(e[t]);
                        return r
                    }(this, e, t)
                }))
            }

            function b(e) {
                return {
                    $date: e.toJSON()
                }
            }

            function A(e) {
                return Array.isArray(e) ? Object.assign([], e) : { ...e
                }
            }

            function S(e) {
                return e.reduce(((e, t, r) => {
                    const [i, n] = Object.entries(t)[0];
                    return "$match" === i && 0 === r ? {
                        preFilteringStep: n
                    } : "$match" === i ? { ...e,
                        postFilteringStep: n
                    } : "$group" === i ? { ...e,
                        processingStep: n
                    } : e
                }), {})
            }

            function O(e) {
                const t = e.lastIndexOf("/");
                return t > -1 ? e.substring(0, t) : null
            }

            function $(e) {
                const t = e.lastIndexOf("/");
                return t > -1 ? e.substring(t + 1) : e
            }

            function j(e) {
                return {
                    namespace: O(e),
                    name: $(e)
                }
            }

            function D({
                headers: e = {},
                query: t = {}
            }) {
                const r = ["uuid", "cid", "authorization", "wixsession2", "cookie"],
                    i = {};
                for (const t in e) {
                    const s = t.toLowerCase();
                    e.hasOwnProperty(t) && (0 === (n = s).indexOf("x-wix") || r.includes(n)) && (i[s] = e[t])
                }
                var n;
                const s = "x-wix-request-id",
                    a = "request_id";
                return t && t[a] && (i[s] || (i[s] = t[a])), i
            }

            function E(e) {
                if (e.status >= 400) {
                    const t = JSON.stringify(e.data),
                        r = new Error(`Request failed with status code ${e.status}. Data: '${t}'.`);
                    throw r.response = e, r.config = e.config, r.request = e.request, r
                }
                return e
            }

            function w(e) {
                return "string" != typeof e && (e = JSON.stringify(e)), btoa(function(e) {
                    if ("function" == typeof TextEncoder) {
                        const t = (new TextEncoder).encode(e);
                        return Array.from(t, (e => String.fromCodePoint(e))).join("")
                    }
                    return e.replace(T, x)
                }(e)).replace(/[+/]/g, (e => P[e])).replace(/={1,3}$/, "")
            }
            const P = {
                "+": "-",
                "/": "_"
            };
            const T = /[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,
                C = e => String.fromCharCode(e);

            function x(e) {
                if (e.length < 2) {
                    const t = e.charCodeAt(0);
                    return t < 128 ? e : t < 2048 ? C(192 | t >>> 6) + C(128 | 63 & t) : C(224 | t >>> 12 & 15) + C(128 | t >>> 6 & 63) + C(128 | 63 & t)
                }
                const t = 65536 + 1024 * (e.charCodeAt(0) - 55296) + (e.charCodeAt(1) - 56320);
                return C(240 | t >>> 18 & 7) + C(128 | t >>> 12 & 63) + C(128 | t >>> 6 & 63) + C(128 | 63 & t)
            }
        },
        83301: function(e) {
            var t = Object.prototype.toString;
            e.exports = function(e) {
                var r = typeof e;
                return "undefined" === r ? "undefined" : null === e ? "null" : !0 === e || !1 === e || e instanceof Boolean ? "boolean" : "string" === r || e instanceof String ? "string" : "number" === r || e instanceof Number ? "number" : "function" === r || e instanceof Function ? void 0 !== e.constructor.name && "Generator" === e.constructor.name.slice(0, 9) ? "generatorfunction" : "function" : void 0 !== Array.isArray && Array.isArray(e) ? "array" : e instanceof RegExp ? "regexp" : e instanceof Date ? "date" : "[object RegExp]" === (r = t.call(e)) ? "regexp" : "[object Date]" === r ? "date" : "[object Arguments]" === r ? "arguments" : "[object Error]" === r ? "error" : "[object Promise]" === r ? "promise" : function(e) {
                    return e.constructor && "function" == typeof e.constructor.isBuffer && e.constructor.isBuffer(e)
                }(e) ? "buffer" : "[object Set]" === r ? "set" : "[object WeakSet]" === r ? "weakset" : "[object Map]" === r ? "map" : "[object WeakMap]" === r ? "weakmap" : "[object Symbol]" === r ? "symbol" : "[object Map Iterator]" === r ? "mapiterator" : "[object Set Iterator]" === r ? "setiterator" : "[object String Iterator]" === r ? "stringiterator" : "[object Array Iterator]" === r ? "arrayiterator" : "[object Int8Array]" === r ? "int8array" : "[object Uint8Array]" === r ? "uint8array" : "[object Uint8ClampedArray]" === r ? "uint8clampedarray" : "[object Int16Array]" === r ? "int16array" : "[object Uint16Array]" === r ? "uint16array" : "[object Int32Array]" === r ? "int32array" : "[object Uint32Array]" === r ? "uint32array" : "[object Float32Array]" === r ? "float32array" : "[object Float64Array]" === r ? "float64array" : "object"
            }
        },
        37511: function(e) {
            var t = Object.prototype.hasOwnProperty;

            function r(e) {
                return "[Throws: " + (e ? e.message : "?") + "]"
            }

            function i(e) {
                var i = [];
                return function e(n) {
                    if (null === n || "object" != typeof n) return n;
                    if (-1 !== i.indexOf(n)) return "[Circular]";
                    if (i.push(n), "function" == typeof n.toJSON) try {
                        var s = e(n.toJSON());
                        return i.pop(), s
                    } catch (e) {
                        return r(e)
                    }
                    if (Array.isArray(n)) {
                        var a = n.map(e);
                        return i.pop(), a
                    }
                    var o = Object.keys(n).reduce((function(i, s) {
                        return i[s] = e(function(e, i) {
                            if (t.call(e, i)) try {
                                return e[i]
                            } catch (e) {
                                return r(e)
                            }
                            return e[i]
                        }(n, s)), i
                    }), {});
                    return i.pop(), o
                }(e)
            }
            e.exports = function(e, t, r) {
                return JSON.stringify(i(e), t, r)
            }, e.exports.ensureProperties = i
        },
        45517: function(e, t, r) {
            "use strict";
            r.d(t, {
                DataSdkFactory: function() {
                    return qe
                }
            });
            var i = r(44704),
                n = r(62673),
                s = r(37511),
                a = r.n(s);

            function o(e) {
                return a()(e)
            }
            const l = {
                    collectionNameMustBeAString: () => "WDE0001: Collection name must be a string.",
                    itemIdMustBeAString: () => "WDE0002: ItemId must be a string.",
                    itemIdsMustBeArrayOfStrings: () => "WDE0068: Item ids must be an array of strings",
                    removeItemsMustBeLessThanThousand: e => `WDE0069: Failed to remove items from [${e}].\nCannot remove more than 1000 items in one request`,
                    fieldNameMustBeAString: () => "WDE0003: FieldName must be a string.",
                    itemMustBeAnObject: (e, t) => `WDE0004: Failed to save [${e}] into [${t}].\nItems must be JavaScript objects.`,
                    itemsMustBeArrayOfObjects: e => `WDE0005: Failed to bulk save items into [${e}].\nItems must be an array of JavaScript objects and itemIds must be strings if present.`,
                    itemsMustBeLessThanThousand: e => `WDE0006: Failed to bulk save items into [${e}].\nCannot insert more than 1000 items in one request`,
                    updateItemInvalid: () => "WDE0007: Invalid update. Updated object must have a string _id property.",
                    invalidArgumentLength: (e, t, r, i) => `WDE0008: wixData.${e} expects between ${t} and ${r} arguments, but was called with ${i}.`,
                    aggregateValidations: {
                        aggregateInvalid: (e, t) => `Failed to perform aggregation on [${e}].\n${t.join("\n")}`,
                        filterMustBeBuilder: e => `WDE0011: Invalid ${e} usage. ${e} requires WixDataFilter.`,
                        filterIsAlreadySet: e => `WDE0012: Invalid ${e} usage. Filter is already set.`,
                        groupIsAlreadySet: e => `WDE0013: Invalid ${e} usage. Group is already set.`
                    },
                    filterBuilderInvalid: e => `Failed to build a filter.\n${e.join("\n")}.`,
                    groupBuilderInvalid: e => `Failed to build group.\n${e.join("\n")}.`,
                    filterMustBeAnObject: () => "WDE0016: Filter must be an object.",
                    sortBuilderInvalid: e => `Failed to build a sort.\n${e.join("\n")}.`,
                    optionsInvalid: e => `WDE0018: Options must be an object with one or all of the following boolean properties: ${e.join(", ")}.`,
                    referenceOperationParameterError: () => "WDE0019: Reference operation takes a string ID or an object with an ID to be connected.",
                    referenceOperationFieldError: e => `WDE0020: Provided property [${e}] is not a multi-reference field.`,
                    invalidReferenceError: () => "WDE0021: Invalid reference",
                    queryValidations: {
                        queryInvalid: (e, t) => `Failed to perform query on [${e}].\n${t.join("\n")}`,
                        isNumber: (e, t, r) => `WDE0032: Invalid ${e} parameter [${(0,i.typeForDisplay)(r)}]. ${e} parameter must be a ${t} number.`,
                        isPositiveNumber: (e, t) => `WDE0033: Invalid ${e} parameter [${t}]. ${e} parameter must be a positive number.`,
                        isNonNegativeNumber: (e, t) => `WDE0034: Invalid ${e} parameter [${t}]. ${e} parameter must be a non-negative number.`,
                        isInteger: (e, t) => `WDE0035: Invalid ${e} parameter [${t}]. ${e} parameter must be an integer.`,
                        isNonEmptyString: e => `WDE0094: Invalid ${e} parameter. ${e} parameter must be non-empty string.`,
                        notGreaterThan: (e, t, r) => `WDE0036: Invalid ${e} parameter [${t}]. ${e} parameter cannot exceed ${r}.`,
                        invalidSkipParameter: (e, t) => `WDE0037: Invalid query on [${e}].\nInvalid prev positioned query skip on a negative number ${t}.`,
                        noPrevPage: e => `WDE0159: Invalid query on [${e}].\nThere is no prev page.`,
                        noNextPage: e => `WDE0165: Invalid query on [${e}].\nThere is no next page.`
                    },
                    arityValidations: {
                        arityIsZero: e => `WDE0038: Invalid ${e} usage. ${e} does not take parameters.`,
                        arityIsOne: e => `WDE0039: Invalid ${e} usage. ${e} requires one parameter.`,
                        arityIsTwo: e => `WDE0040: Invalid ${e} usage. ${e} requires two parameters.`,
                        arityIsThree: e => `WDE0041: Invalid ${e} usage. ${e} requires three parameters.`,
                        arityIsAtLeastTwo: e => `WDE0042: Invalid ${e} usage. ${e} requires at least two parameters.`,
                        arityIsAtLeastOne: e => `WDE0043: Invalid ${e} usage. ${e} requires at least one parameter.`
                    },
                    filterValidations: {
                        typeIsString: (e, t) => `WDE0044: Invalid ${e} parameter value [${(0,i.typeForDisplay)(t)}]. ${e} parameter must be a String.`,
                        typeIsStringNumberOrDate: (e, t) => `WDE0045: Invalid ${e} parameter value [${(0,i.typeForDisplay)(t)}]. Valid ${e} parameter types are String, Number or Date.`,
                        sameType: (e, t, r) => `WDE0046: Invalid ${e} parameter values [${(0,i.typeForDisplay)(t)}] and [${(0,i.typeForDisplay)(r)}]. Both parameters must be of the same type.`,
                        typeIsStringNumberOrDateForAll: e => `WDE0047: Invalid ${e} usage. ${e} supports only Number, String or Date items.`,
                        validFieldName: (e, t) => `WDE0048: Invalid ${e} field value [${(0,i.typeForDisplay)(t)}]. ${e} field must be a String.`,
                        isInstanceOfSameClass: (e, t, r) => `WDE0049: Invalid ${e} parameter [${(0,i.typeForDisplay)(r)}]. ${e} expects ${t} only.`,
                        isForCollection: (e, t, r) => `WDE0050: Invalid ${e} parameter query for [${r}]. ${e} accepts ${t} for the same collection only.`
                    },
                    filterTreeValidations: {
                        objectType: (e, t) => `WDE0056: ${e} should be an Object. Got ${o(t)} instead`,
                        arrayType: (e, t) => `WDE0057: ${e} should be an Array. Got ${o(t)} instead`,
                        arrayLength: (e, t, r) => `WDE0057: ${o(r)}.length is ${r.length}. ${e} Array should have length ${t}`,
                        comparisonOperatorType: (e, t) => `WDE0058: ${e} should be a Date, Number, or String. Got ${o(t)} instead`,
                        stringOperatorType: (e, t) => `WDE0059: ${e} should be a String. Got ${o(t)} instead`,
                        setOperatorItems: (e, t) => `WDE0060: ${e} Array should only contain values of types Date, Number, and String. Got ${o(t)} instead`,
                        inOperatorItems: e => `WDE0061: $in Array should have length 2, and match [String, Number]. Got ${o(e)} instead`,
                        matchesOperatorRequiredProperty: (e, t) => `WDE0062: $matches value ${o(t)} does not have property ${e}`,
                        matchesOperatorIgnoreCase: e => `WDE0063: $matches.ignoreCase should equal true. Got ${o(e)} instead`,
                        matchesOperatorSpecItems: e => `WDE0064: $matches.spec Array values should be either {"type":"anyOf","value":" -"} or {"type":"literal","value":String}. Got ${o(e)} instead`,
                        regexNotAllowed: () => "WDE0070: $regex keyword is not allowed."
                    },
                    sortValidations: {
                        typeIsStringOrArrayOfStrings: (e, t) => `WDE0051: Invalid ${e} parameters [${t.map(i.typeForDisplay)}]. Valid ${e} values are String, Array of String or varargs String.`
                    },
                    orderByValidations: {
                        sortModelType: e => `WDE0065: Sort Model should be an Array. Got ${o(e)} instead`,
                        sortModelItemType: e => `WDE0066: Sort Model Array should contain values of type Object only. Got ${o(e)} instead`,
                        sortModelItem: e => `WDE0067: Sort Model Array items should have a single property with value "asc" or "desc". Got ${o(e)} instead`
                    },
                    internalError: e => `WDE0053: Internal wixData error: ${e}`,
                    serverInvalidResponse: e => "WDE0055: Failed to parse server response." + (e ? ` ${e}` : ""),
                    itemDoesNotExist: (e, t) => `WDE0073: Item [${e}] does not exist in collection [${t}].`,
                    cursorPagingDoesNotSupportSkip: () => "WDE0080: Skip is not supported in cursor paging.",
                    payloadIsTooLarge: () => "WDE0109: Payload is too large."
                },
                u = {
                    ItemDoesNotExist: "WD_ITEM_DOES_NOT_EXIST",
                    ItemAlreadyExists: "WD_ITEM_ALREADY_EXISTS",
                    SiteInTemplateMode: "WD_SITE_IN_TEMPLATE_MODE",
                    UnknownError: "WD_UNKNOWN_ERROR",
                    ValidationError: "WD_VALIDATION_ERROR",
                    CollectionDeleted: "WD_COLLECTION_DELETED",
                    SchemaDoesNotExist: "WD_SCHEMA_DOES_NOT_EXIST",
                    PermissionDenied: "WD_PERMISSION_DENIED",
                    BadRequest: "WD_BAD_REQUEST",
                    Unauthorized: "WD_UNAUTHORIZED",
                    TooManyRequests: "WD_TOO_MANY_REQUESTS",
                    RequestTimedOut: "WD_REQUEST_TIMED_OUT",
                    QuotaExceeded: "WD_DATABASE_QUOTA_EXCEEDED",
                    QueryExecutionError: "WD_QUERY_EXECUTION_ERROR"
                };

            function c(e, t, r) {
                return h(e, t, r)
            }

            function d(e) {
                return h(e, u.ValidationError)
            }

            function h(e, t, r) {
                const i = new(t && t !== u.UnknownError ? m : Error)(e);
                return i.code = t, r && (i.details = r), i
            }

            function p(e, t, r, i, n) {
                const s = new Error(e);
                return i && (s.name = i), s.code = t, s.item = r, s.originalIndex = n, Object.setPrototypeOf(s, Object.getPrototypeOf(this)), Error.captureStackTrace && Error.captureStackTrace(s, p), s
            }

            function m(e) {
                const t = new n.UserCodeError(e);
                return Object.setPrototypeOf(t, Object.getPrototypeOf(this)), Error.captureStackTrace && Error.captureStackTrace(t, m), t.name = Error.name, t
            }
            p.prototype = Object.create(Error.prototype, {
                constructor: {
                    value: Error,
                    enumerable: !1,
                    writable: !0,
                    configurable: !0
                }
            }), m.prototype = Object.create(n.UserCodeError.prototype, {
                constructor: {
                    value: m,
                    enumerable: !1,
                    writable: !0,
                    configurable: !0
                }
            });
            class g {
                constructor() {
                    this._validations = []
                }
                arityIsZero(e) {
                    return this.addValidation((() => 0 === e.length), (() => l.arityValidations.arityIsZero(this.operatorName)))
                }
                arityIsOne(e) {
                    return this.addValidation((() => 1 === e.length), (() => l.arityValidations.arityIsOne(this.operatorName)))
                }
                arityIsTwo(e) {
                    return this.addValidation((() => 2 === e.length), (() => l.arityValidations.arityIsTwo(this.operatorName)))
                }
                arityIsThree(e) {
                    return this.addValidation((() => 3 === e.length), (() => l.arityValidations.arityIsThree(this.operatorName)))
                }
                arityIsAtLeastTwo(e) {
                    return this.addValidation((() => e.length >= 2), (() => l.arityValidations.arityIsAtLeastTwo(this.operatorName)))
                }
                arityIsAtLeastOne(e) {
                    return this.addValidation((() => e.length >= 1), (() => l.arityValidations.arityIsAtLeastOne(this.operatorName)))
                }
                addValidation(e, t) {
                    return this._validations.push({
                        predicateFn: e,
                        messageFn: t
                    }), this
                }
            }
            class f extends g {
                constructor(e) {
                    super(), this._invalidArguments = (0, i.clone)(e)
                }
                validateAndAggregate() {
                    const e = this._validations.every((({
                        predicateFn: e,
                        messageFn: t
                    }) => this._appendIfInvalid(e(), t())));
                    return [this._invalidArguments, e]
                }
                _appendIfInvalid(e, t) {
                    return !!e || (this._invalidArguments.push(t), !1)
                }
            }
            class v extends g {
                validateAndReject() {
                    return Promise.resolve().then((() => {
                        this._validations.forEach((({
                            predicateFn: e,
                            messageFn: t
                        }) => {
                            if (!e()) throw d(t())
                        }))
                    }))
                }
                validateAndReturn() {
                    const e = [];
                    return this._validations.forEach((({
                        predicateFn: t,
                        messageFn: r
                    }) => {
                        t() || e.push(r())
                    })), e
                }
            }
            class y extends v {
                arity(e, t, r, i) {
                    return this.addValidation((() => t.length <= i && t.length >= r), (() => l.invalidArgumentLength(e, r, i, t.length)))
                }
                _isObject(e, t) {
                    return this.addValidation((() => (0, i.isObject)(e)), (() => l.itemMustBeAnObject(e, t)))
                }
                item(e, t, r) {
                    return this._isObject(e, t).addValidation((() => void 0 !== e._id ? (0, i.isString)(e._id) : !r), (() => l.updateItemInvalid()))
                }
                items(e, t) {
                    return this.addValidation((() => (0, i.isArray)(e) && e.every((e => (0, i.isObject)(e) && (void 0 === e._id || null === e._id || (0, i.isString)(e._id))))), (() => l.itemsMustBeArrayOfObjects(t))).addValidation((() => e.length <= 1e3), (() => l.itemsMustBeLessThanThousand(t)))
                }
                fieldName(e) {
                    return this.addValidation((() => (0, i.isString)(e)), (() => l.fieldNameMustBeAString()))
                }
                itemId(e) {
                    return this.addValidation((() => (0, i.isString)(e)), (() => l.itemIdMustBeAString()))
                }
                itemIds(e, t) {
                    return this.addValidation((() => (0, i.isArray)(e) && e.every((e => (0, i.isString)(e)))), (() => l.itemIdsMustBeArrayOfStrings())).addValidation((() => e.length <= 1e3), (() => l.removeItemsMustBeLessThanThousand(t)))
                }
                _options(e, t) {
                    return this.addValidation((() => {
                        const r = (0, i.isObject)(e) && t.every((t => {
                            return "language" === t ? null == (r = e[t]) || (0, i.isString)(r) && r.length > 0 : function(e) {
                                return null == e || (0, i.isBoolean)(e)
                            }(e[t]);
                            var r
                        }));
                        return null == e || r
                    }), (() => l.optionsInvalid(t)))
                }
                referenceRemoveParameters(e) {
                    return this.addValidation((() => (0, i.isArray)(e) && e.every(I)), l.referenceOperationParameterError)
                }
                referenceParameters(e) {
                    return this.addValidation((() => (0, i.isArray)(e) && e.every(_)), l.referenceOperationParameterError)
                }
                referenceParameter(e) {
                    return this.addValidation((() => _(e)), l.referenceOperationParameterError)
                }
                isNonEmptyString(e, t) {
                    return this.addValidation((() => "string" == typeof e && e.length > 0), (() => l.queryValidations.isNonEmptyString(t)))
                }
                references(e) {
                    return this.addValidation((() => (0, i.isArray)(e) && e.every((e => (0, i.isString)(e.relationshipName) && _(e.left) && _(e.right)))), l.invalidReferenceError)
                }
                options(e) {
                    return this._options(e, ["suppressAuth", "suppressHooks", "showDrafts", "consistentRead", "language"])
                }
                bulkInsertOptions(e) {
                    return this._options(e, ["suppressAuth", "suppressHooks", "overrideExisting"])
                }
                bulkUpdateOptions(e) {
                    return this._options(e, ["suppressAuth", "suppressHooks", "showDrafts"])
                }
                bulkRemoveOptions(e) {
                    return this._options(e, ["suppressAuth", "suppressHooks", "showDrafts"])
                }
                truncateOptions(e) {
                    return this._options(e, ["suppressAuth"])
                }
                collectionName(e) {
                    return this.addValidation((() => (0, i.isString)(e)), (() => l.collectionNameMustBeAString()))
                }
            }

            function N() {
                return new y
            }

            function _(e) {
                return (0, i.isString)(e) && "" !== e || (0, i.isObject)(e) && e.hasOwnProperty("_id")
            }

            function I(e) {
                return (0, i.isString)(e) || (0, i.isObject)(e) && e.hasOwnProperty("_id")
            }
            var b = r(69012),
                A = r.n(b);

            function S(e) {
                return "array" === A()(e)
            }

            function O(e) {
                return "date" === A()(e)
            }

            function $(e) {
                return "string" === A()(e)
            }

            function j(e) {
                return function(e) {
                    if (!$(e)) return e;
                    const t = e.slice(0, 1).toUpperCase(),
                        r = e.slice(1, e.length);
                    return t + r
                }(A()(e))
            }

            function D(e) {
                if (null == e || "object" != typeof e) return e;
                let t = null;
                if (O(e)) t = new Date(e.getTime());
                else {
                    t = e.constructor();
                    for (const r in e) t[r] = D(e[r])
                }
                return t
            }
            class E {
                constructor(e, t, r) {
                    this._validations = [], this.operatorName = e, this.ctor = r, this._invalidArguments = D(t)
                }
                typeIsString(e) {
                    return this.addValidation((() => $(e)), (() => `Invalid ${this.operatorName} parameter value [${j(e)}]. ${this.operatorName} parameter must be a String.`))
                }
                typeIsStringNumberOrDate(e) {
                    return this.addValidation((() => w(e)), (() => `Invalid ${this.operatorName} parameter value [${j(e)}]. Valid ${this.operatorName} parameter types are String, Number or Date.`))
                }
                sameType(e, t) {
                    return this.addValidation((() => j(e) === j(t)), (() => `Invalid ${this.operatorName} parameter values [${j(e)}] and [${j(t)}]. Both parameters must be of the same type.`))
                }
                typeIsStringNumberOrDateForAll(e) {
                    return this.addValidation((() => e.every(w)), (() => `Invalid ${this.operatorName} usage. ${this.operatorName} supports only Number, String or Date items.`))
                }
                validFieldName(e) {
                    return this.addValidation((() => $(e)), (() => `Invalid ${this.operatorName} field value [${j(e)}]. ${this.operatorName} field must be a String.`))
                }
                isInstanceOfSameClass(e) {
                    return this.addValidation((() => e instanceof this.ctor), (() => `Invalid ${this.operatorName} parameter [${j(e)}]. ${this.operatorName} expects FilterBuilder only.`))
                }
                arityIsOne(e) {
                    return this.addValidation((() => 1 === e.length), (() => `Invalid ${this.operatorName} usage. ${this.operatorName} requires one parameter.`))
                }
                arityIsTwo(e) {
                    return this.addValidation((() => 2 === e.length), (() => `Invalid ${this.operatorName} usage. ${this.operatorName} requires two parameters.`))
                }
                arityIsThree(e) {
                    return this.addValidation((() => 3 === e.length), (() => `Invalid ${this.operatorName} usage. ${this.operatorName} requires three parameters.`))
                }
                arityIsAtLeastTwo(e) {
                    return this.addValidation((() => e.length >= 2), (() => `Invalid ${this.operatorName} usage. ${this.operatorName} requires at least two parameters.`))
                }
                addValidation(e, t) {
                    return this._validations.push({
                        predicateFn: e,
                        messageFn: t
                    }), this
                }
                validateAndAggregate() {
                    const e = this._validations.every((({
                        predicateFn: e,
                        messageFn: t
                    }) => this._appendIfInvalid(e(), t())));
                    return [this._invalidArguments, e]
                }
                _appendIfInvalid(e, t) {
                    return !!e || (this._invalidArguments.push(t), !1)
                }
            }

            function w(e) {
                return $(e) || (t = e, "number" === A()(t)) || O(e);
                var t
            }
            const P = [function(e) {
                const t = e.$and;
                if (Array.isArray(t) && 1 === t.length) return t[0]
            }, function(e) {
                const t = e.$and;
                if (Array.isArray(t) && 0 === t.length) return {};
                return null
            }, function(e) {
                const t = e.$and;
                if (!t) return;
                let r = [],
                    i = [];
                if (t.forEach((e => {
                        ! function(e) {
                            const t = Object.keys(e);
                            return t.every((e => e.startsWith("$"))) && t.length > 0
                        }(e) ? r = [...r, e]: i = [...i, e]
                    })), r.length <= 1 || function(e) {
                        const t = e.map((e => Object.keys(e))).reduce(((e, t) => [...e, ...t]), []);
                        return function(e) {
                            const t = {};
                            return e.forEach((e => t[e] = !0)), Object.keys(t)
                        }(t).length !== t.length
                    }(r)) return;
                return {
                    $and: [Object.assign({}, ...r), ...i]
                }
            }, function(e) {
                const t = e.$and;
                if (!t) return;
                if (!t.find((e => e.$and))) return;
                return {
                    $and: t.reduce(((e, t) => {
                        const r = t.$and;
                        return r ? [...e, ...r] : [...e, t]
                    }), [])
                }
            }, function(e) {
                const t = e.$or;
                if (!t) return;
                if (!t.find((e => e.$or))) return;
                return {
                    $or: t.reduce(((e, t) => {
                        const r = t.$or;
                        return r ? [...e, ...r] : [...e, t]
                    }), [])
                }
            }];

            function T(e) {
                const [t] = C(e);
                return t
            }

            function C(e) {
                return Array.isArray(e) ? function(e) {
                    const t = e.map(C),
                        r = 0 < t.filter((([, e]) => e)).length;
                    return [t.map((([e]) => e)), r]
                }(e) : "object" != typeof e || null === e || e instanceof Date ? [e, !1] : function(e) {
                    const [t, r] = a(e), [i, n] = s(t);
                    return [i, r || n];

                    function s(e) {
                        const t = function(e) {
                            for (const t of P) {
                                const r = t(e);
                                if (r) return r
                            }
                        }(e);
                        if (!t) return [e, !1];
                        const [r] = C(t);
                        return [r, !0]
                    }

                    function a(e) {
                        const t = Object.entries(e).map(o).filter((([, , e]) => e));
                        return [{ ...e,
                            ...l(t)
                        }, !!t.length]
                    }

                    function o([e, t]) {
                        const [r, i] = C(t);
                        return [e, r, i]
                    }

                    function l(e) {
                        return e.reduce(((e, [t, r]) => ({ ...e,
                            [t]: r
                        })), {})
                    }
                }(e)
            }

            function x(...e) {
                return {
                    $and: e
                }
            }

            function W(e) {
                return e && e.$and && 0 === e.$and.length
            }
            var k = (e = class {}) => class extends e {
                constructor(e = {}) {
                    super(e), this.filterTree = e.filterTree || {
                        $and: []
                    }, this.invalidArguments = e.invalidArguments || [], this.encoder = e.encoder || {}
                }
                eq(...e) {
                    return this._binaryAnd("$eq", ".eq", e)
                }
                ne(...e) {
                    return this._binaryAnd("$ne", ".ne", e)
                }
                ge(...e) {
                    return this._AndLogicalEquivalence("$gte", ".ge", e)
                }
                gt(...e) {
                    return this._AndLogicalEquivalence("$gt", ".gt", e)
                }
                le(...e) {
                    return this._AndLogicalEquivalence("$lte", ".le", e)
                }
                lt(...e) {
                    return this._AndLogicalEquivalence("$lt", ".lt", e)
                }
                isNotEmpty(e) {
                    const [t, r] = this._filterValidator(".isNotEmpty").arityIsOne(arguments).validFieldName(e).validateAndAggregate();
                    return r ? this.ne(e, null) : this._copy(this.filterTree, t)
                }
                isEmpty(e) {
                    const [t, r] = this._filterValidator(".isEmpty").arityIsOne(arguments).validFieldName(e).validateAndAggregate();
                    return r ? this.eq(e, null) : this._copy(this.filterTree, t)
                }
                startsWith(...e) {
                    return this._AndStringOperand("$startsWith", ".startsWith", e)
                }
                endsWith(...e) {
                    return this._AndStringOperand("$endsWith", ".endsWith", e)
                }
                contains(...e) {
                    return this._AndStringOperand("$contains", ".contains", e)
                }
                hasSome(...e) {
                    return this._AndSetOperand("$hasSome", ".hasSome", e)
                }
                hasAll(...e) {
                    return this._AndSetOperand("$hasAll", ".hasAll", e)
                }
                or(e) {
                    const [t, r] = this._filterValidator(".or").arityIsOne(arguments).isInstanceOfSameClass(e).validateAndAggregate();
                    if (r) {
                        const r = W(this.filterTree) ? [] : [this.filterTree];
                        return this._copy(x({
                            $or: [...r, e.filterTree]
                        }), t.concat(e.invalidArguments))
                    }
                    return this._copy(this.filterTree, t)
                }
                and(e) {
                    const [t, r] = this._filterValidator(".and").arityIsOne(arguments).isInstanceOfSameClass(e).validateAndAggregate();
                    if (r) {
                        const r = W(this.filterTree) ? [] : [this.filterTree];
                        return this._copy(x(...r, e.filterTree), t.concat(e.invalidArguments))
                    }
                    return this._copy(this.filterTree, t)
                }
                not(e) {
                    const [t, r] = this._filterValidator(".not").arityIsOne(arguments).isInstanceOfSameClass(e).validateAndAggregate();
                    if (r) {
                        const r = function(...e) {
                            return {
                                $and: e.reduce(((e, t) => S(t.$and) ? e.concat(t.$and) : e.concat([t])), [])
                            }
                        }(D(this.filterTree), {
                            $not: [e.filterTree]
                        });
                        return this._copy(r, t.concat(e.invalidArguments))
                    }
                    return this._copy(this.filterTree, t)
                }
                between(e, t, r) {
                    const [i, n] = this._filterValidator(".between").arityIsThree(arguments).sameType(t, r).typeIsStringNumberOrDate(t).typeIsStringNumberOrDate(r).validateAndAggregate();
                    return n ? this.ge(e, t).lt(e, r) : this._copy(this.filterTree, i)
                }
                getFilterModel() {
                    if (this.invalidArguments.length > 0) throw new Error(this.invalidArguments.join(" "));
                    return T(this.filterTree)
                }
                setFilterModel(e) {
                    return this._copy(e, [])
                }
                _binaryAnd(e, t, r) {
                    const [i, n] = Array.prototype.slice.call(r), [s] = this._filterValidator(t).arityIsTwo(r).validFieldName(i).validateAndAggregate(), a = this._makeNewFilter(i, e, n);
                    return this._copy(a, s)
                }
                _AndLogicalEquivalence(e, t, r) {
                    const [i, n] = Array.prototype.slice.call(r), [s] = this._filterValidator(t).arityIsTwo(r).validFieldName(i).typeIsStringNumberOrDate(n).validateAndAggregate(), a = this._makeNewFilter(i, e, n);
                    return this._copy(a, s)
                }
                _AndStringOperand(e, t, r) {
                    const [i, n] = Array.prototype.slice.call(r), [s] = this._filterValidator(t).arityIsTwo(r).validFieldName(i).typeIsString(n).validateAndAggregate(), a = this._makeNewFilter(i, e, n);
                    return this._copy(a, s)
                }
                _AndSetOperand(e, t, r) {
                    const [i, ...n] = Array.prototype.slice.call(r), s = S(n[0]) ? n[0] : n, [a] = this._filterValidator(t).arityIsAtLeastTwo(r).validFieldName(i).typeIsStringNumberOrDateForAll(s).validateAndAggregate(), o = this._makeNewFilter(i, e, s);
                    return this._copy(o, a)
                }
                _makeNewFilter(e, t, r) {
                    const i = D(this.filterTree),
                        n = void 0 === r ? null : r,
                        s = this._buildFilter(e, t, n);
                    if (S(i.$and)) return i.$and.push(s), i;
                    return a = i, 0 === Object.keys(a).length ? x(s) : x(i, s);
                    var a
                }
                _buildFilter(e, t, r) {
                    if ("$eq" !== t) {
                        const i = {};
                        return i[e] = {}, i[e][t] = this._encode(r), i
                    } {
                        const t = {};
                        return t[e] = this._encode(r), t
                    }
                }
                _encode(e) {
                    return t = this.encoder, "function" === A()(t) ? this.encoder(e) : e;
                    var t
                }
                _copy(e, t) {
                    return new this.constructor({ ...this,
                        filterTree: e,
                        invalidArguments: t
                    })
                }
                _filterValidator(e) {
                    return new E(e, this.invalidArguments, this.constructor)
                }
            };
            k();

            function R(e) {
                const t = e.split("-"),
                    r = [];
                for (let e = 0; e < t.length - 1; e++) i(r, t[e]), r.push({
                    type: "anyOf",
                    value: " \t\n-"
                });
                return i(r, t[t.length - 1]), r;

                function i(e, t) {
                    0 !== t.length && e.push({
                        type: "literal",
                        value: t
                    })
                }
            }
            class V extends f {
                constructor(e, t, r, i) {
                    super(t), this.operatorName = e, this.ctor = r, this.constructorName = i
                }
                typeIsString(e) {
                    return this.addValidation((() => (0, i.isString)(e)), (() => l.filterValidations.typeIsString(this.operatorName, e)))
                }
                typeIsStringNumberOrDate(e) {
                    return this.addValidation((() => F(e)), (() => l.filterValidations.typeIsStringNumberOrDate(this.operatorName, e)))
                }
                sameType(e, t) {
                    return this.addValidation((() => (0, i.typeForDisplay)(e) === (0, i.typeForDisplay)(t)), (() => l.filterValidations.sameType(this.operatorName, e, t)))
                }
                typeIsStringNumberOrDateForAll(e) {
                    return this.addValidation((() => e.every(F)), (() => l.filterValidations.typeIsStringNumberOrDateForAll(this.operatorName)))
                }
                validFieldName(e) {
                    return this.addValidation((() => (0, i.isString)(e)), (() => l.filterValidations.validFieldName(this.operatorName, e)))
                }
                isInstanceOfSameClass(e) {
                    return this.addValidation((() => e instanceof this.ctor), (() => l.filterValidations.isInstanceOfSameClass(this.operatorName, this.constructorName, e)))
                }
                isForCollection(e, t) {
                    return this.addValidation((() => e.collectionName === t), (() => l.filterValidations.isForCollection(this.operatorName, this.constructorName, e.collectionName)))
                }
            }

            function F(e) {
                return (0, i.isString)(e) || (0, i.isNumber)(e) || (0, i.isDate)(e)
            }
            var B = (e = class {}) => class extends(k(e)) {
                constructor(e) {
                    super(e), this.validateCollectionName = e ? .validateCollectionName ? ? !0
                }
                or(e) {
                    const t = super.or.apply(this, arguments);
                    return this._validateCollectionName(t, e, ".or")
                }
                and(e) {
                    const t = super.and.apply(this, arguments);
                    return this._validateCollectionName(t, e, ".and")
                }
                not(e) {
                    const t = super.not.apply(this, arguments);
                    return this._validateCollectionName(t, e, ".not")
                }
                _validateCollectionName(e, t, r) {
                    if (e.invalidArguments.length > 0 || !this.validateCollectionName) return e;
                    const i = function(e, t) {
                            if (!e || !e.constructor) return e;
                            const r = e.collectionName ? e.collectionName : t;
                            return new e.constructor({ ...e,
                                collectionName: r
                            })
                        }(t, this.collectionName),
                        [n, s] = new V(r, e.invalidArguments, this.constructor, this.constructorName ? ? this.constructor.name).isForCollection(i, this.collectionName).validateAndAggregate();
                    return s ? e : this._copy(this.filterTree, n)
                }
                _matchesUrlized(e, t) {
                    const [r, i] = this._filterValidator("._matchesUrlized").arityIsTwo(arguments).validFieldName(e).typeIsString(t).validateAndAggregate();
                    if (i) {
                        const i = this._makeNewFilter(e, ... function(e) {
                            return t(e) ? ["$in", [e, Number.parseInt(e)]] : ["$matches", {
                                ignoreCase: !0,
                                spec: R(e)
                            }];

                            function t(e) {
                                return /^-?[0-9]{1,16}$/.test(e)
                            }
                        }(t));
                        return this._copy(i, r)
                    }
                    return this._copy(this.filterTree, r)
                }
                getFilterModel() {
                    if (this.invalidArguments.length > 0) throw d(l.filterBuilderInvalid(this.invalidArguments));
                    return super.getFilterModel()
                }
                _filterValidator(e) {
                    return new V(e, this.invalidArguments, this.constructor, this.constructorName ? ? this.constructor.name)
                }
            };
            class q extends(B()) {
                get constructorName() {
                    return "FilterBuilder"
                }
                _build() {
                    return this.getFilterModel()
                }
            }
            B();

            function M() {
                return new q({})
            }
            const {
                filterTreeValidations: U
            } = l;
            const z = (e = class {}) => class extends e {
                constructor(e = {}) {
                    super(e), this.orderBy = e.orderBy || [], this.invalidArguments = e.invalidArguments || []
                }
                ascending(...e) {
                    return this._sortClause("asc", ".ascending", e)
                }
                descending(...e) {
                    return this._sortClause("desc", ".descending", e)
                }
                getSortModel() {
                    if (this.invalidArguments.length > 0) throw d(l.sortBuilderInvalid(this.invalidArguments));
                    return this.orderBy
                }
                setSortModel(e) {
                    return this._copySort(e, [])
                }
                _sortClause(e, t, r) {
                    let n = [];
                    this.orderBy && (n = (0, i.clone)(this.orderBy));
                    const s = (a = n, o = e, e => {
                        const t = {};
                        t[e] = o, a.push(t)
                    });
                    var a, o;
                    const l = (0, i.isArray)(r[0]) && 1 === r.length ? r[0] : Array.prototype.slice.call(r, 0),
                        [u, c] = this._sortValidator(t).arityIsAtLeastOne(r).allStrings(l).validateAndAggregate();
                    return c && l.forEach(s), this._copySort(n, u)
                }
                _sortValidator(e) {
                    return new G(e, this.invalidArguments)
                }
                _copySort(e, t) {
                    return new this.constructor({ ...this,
                        orderBy: e,
                        invalidArguments: t
                    })
                }
            };
            class G extends f {
                constructor(e, t) {
                    super(t), this.operatorName = e
                }
                allStrings(e) {
                    return this.addValidation((() => e.every(i.isString)), (() => l.sortValidations.typeIsStringOrArrayOfStrings(this.operatorName, e)))
                }
            }
            z();
            var L = z;

            function Q(e) {
                return "string" == typeof e && e.length > 0
            }
            class H {
                constructor(e) {
                    e && (this.count = e.count, this.total = e.total, this.cursors = e.cursors, this.hasNext = e.hasNext, this.hasPrev = e.hasPrev)
                }
            }

            function J(e, t, r) {
                const i = e.skipNumber || 0;
                let n = void 0 === e.limitNumber ? t : e.limitNumber;
                return r && (n = Math.min(n, t)), r ? i + n : i - n
            }
            const X = 9007199254740991;
            class Z extends f {
                constructor(e, t) {
                    super(t), this.operatorName = e
                }
                _isNumber(e, t) {
                    return this.addValidation((() => (0, i.isNumber)(t)), (() => l.queryValidations.isNumber(this.operatorName, e, t)))
                }
                isPositiveNumber(e) {
                    return this._isNumber("positive", e).addValidation((() => !Number.isNaN(e) && e > 0), (() => l.queryValidations.isPositiveNumber(this.operatorName, e)))
                }
                isNonNegativeNumber(e) {
                    return this._isNumber("non-negative", e).addValidation((() => !Number.isNaN(e) && e >= 0), (() => l.queryValidations.isNonNegativeNumber(this.operatorName, e)))
                }
                isInteger(e) {
                    return this.addValidation((() => !Number.isNaN(e) && Number.isFinite(e) && Number.isInteger(e) && e < X && e > -9007199254740991), (() => l.queryValidations.isInteger(this.operatorName, e)))
                }
                notGreaterThan(e, t) {
                    return this.addValidation((() => e <= t), (() => l.queryValidations.notGreaterThan(this.operatorName, e, t)))
                }
            }
            class Y extends(B(L())) {
                constructor(e) {
                    super(e), this.provider = e.provider, this.collectionName = e.collectionName, this.limitNumber = e.limitNumber, this.invalidArguments = e.invalidArguments, this.orderBy = e.orderBy, this.skipNumber = e.skipNumber, this.included = e.included, this.projectedFields = e.projectedFields, this.cursor = e.cursor
                }
                get constructorName() {
                    return "WixDataQuery"
                }
                count(e) {
                    return K(this.invalidArguments, this.collectionName).then((() => N().options(e).validateAndReject())).then((() => this.provider.count(this.collectionName, this.getOptimizedFilter(), e))).then((e => e.totalCount))
                }
                distinct(e, t) {
                    const r = this,
                        i = (t || {}).omitTotalCount,
                        n = this.cursor ? void 0 : this.skipNumber,
                        s = this.cursor ? "" : e;
                    return K(this.invalidArguments, this.collectionName).then((() => N().options(t).validateAndReject())).then((() => N().fieldName(s).validateAndReject())).then((() => this.provider.distinct(this.collectionName, this.getOptimizedFilter(), this.orderBy, s, n, this.limitNumber, t, this.cursor, void 0, i))).then((e => {
                        const i = e.pagingMetadata || new H,
                            {
                                cursors: n,
                                hasNext: a = !1
                            } = i,
                            o = Q(n ? .next) || Q(n ? .prev) ? { ...t,
                                omitTotalCount: !0
                            } : t;
                        return new te({
                            createdByCursor: this.cursor,
                            items: e.items,
                            length: e.items.length,
                            query: r,
                            totalCount: e.totalCount,
                            cursors: n,
                            partialIncludes: !1,
                            pagingFunction() {
                                return this.distinct(s, o)
                            },
                            hasNext: a
                        })
                    }))
                }
                _transformOrderingForAggregates(e = [], t) {
                    return e.length > 0 ? e.filter((e => e.hasOwnProperty(t))).map((e => ({
                        _id: e[t]
                    }))) : null
                }
                _distinctValuesPipeline(e) {
                    return [this.filterTree && Object.keys(this.filterTree).length > 0 ? {
                        $match: this.filterTree
                    } : null, {
                        $distinct: `$${e}`
                    }].filter(this._stageFilter)
                }
                _stageFilter(e) {
                    return null !== e
                }
                fields(...e) {
                    const t = (0, i.clone)(this.projectedFields);
                    for (let r = 0; r < e.length; r++) t.push(e[r]);
                    return new Y({
                        provider: this.provider,
                        collectionName: this.collectionName,
                        filterTree: this.filterTree,
                        orderBy: this.orderBy,
                        skipNumber: this.skipNumber,
                        limitNumber: this.limitNumber,
                        invalidArguments: this.invalidArguments,
                        included: this.included,
                        cursor: this.cursor,
                        projectedFields: t
                    })
                }
                find(e) {
                    const t = this,
                        r = (e || {}).omitTotalCount;
                    return K(this.invalidArguments, this.collectionName).then((() => N().options(e).validateAndReject())).then((() => {
                        const t = this.cursor ? void 0 : this.skipNumber;
                        return this.provider.find(this.collectionName, this.getOptimizedFilter(), this.orderBy, t, this.limitNumber, e, this.included, r, this.cursor, this.projectedFields)
                    })).then((r => {
                        const i = r.pagingMetadata.cursors,
                            n = Q(i ? .next) || Q(i ? .prev) ? { ...e,
                                omitTotalCount: !0
                            } : e;
                        return new te({
                            createdByCursor: this.cursor,
                            totalCount: r.totalCount,
                            query: t,
                            items: r.items,
                            cursors: i,
                            partialIncludes: r.partialIncludes,
                            hasNext: r.pagingMetadata.hasNext,
                            pagingFunction() {
                                return this.find(n)
                            }
                        })
                    }))
                }
                limit(e) {
                    const [t] = this._queryValidator(".limit").arityIsOne(arguments).isPositiveNumber(e).isInteger(e).validateAndAggregate();
                    return new Y({
                        provider: this.provider,
                        collectionName: this.collectionName,
                        filterTree: this.filterTree,
                        orderBy: this.orderBy,
                        skipNumber: this.skipNumber,
                        limitNumber: e,
                        included: this.included,
                        cursor: this.cursor,
                        invalidArguments: t,
                        projectedFields: this.projectedFields
                    })
                }
                skip(e) {
                    const [t] = this._queryValidator(".skip").arityIsOne(arguments).isNonNegativeNumber(e).isInteger(e).validateAndAggregate();
                    return new Y({
                        provider: this.provider,
                        collectionName: this.collectionName,
                        filterTree: this.filterTree,
                        orderBy: this.orderBy,
                        skipNumber: e,
                        limitNumber: this.limitNumber,
                        included: this.included,
                        cursor: this.cursor,
                        invalidArguments: t,
                        projectedFields: this.projectedFields
                    })
                }
                include(...e) {
                    const t = (0, i.clone)(this.included);
                    for (let r = 0; r < e.length; r++) t.push(e[r]);
                    return new Y({
                        provider: this.provider,
                        collectionName: this.collectionName,
                        filterTree: this.filterTree,
                        orderBy: this.orderBy,
                        skipNumber: this.skipNumber,
                        limitNumber: this.limitNumber,
                        invalidArguments: this.invalidArguments,
                        included: t,
                        cursor: this.cursor,
                        projectedFields: this.projectedFields
                    })
                }
                setFilterModel(e) {
                    const t = super.setFilterModel(e);
                    return this._setQuerySpecificInvalidArguments(t)
                }
                getOptimizedFilter() {
                    try {
                        return T(this.filterTree)
                    } catch (e) {
                        return this.filterTree
                    }
                }
                setSortModel(e) {
                    const t = super.setSortModel(e);
                    return this._setQuerySpecificInvalidArguments(t)
                }
                _setQuerySpecificInvalidArguments(e) {
                    const t = (e, t) => void 0 !== e ? t.validateAndAggregate()[0] : [],
                        r = this._queryValidator(".limit", []).isPositiveNumber(this.limitNumber).isInteger(this.limitNumber),
                        i = this._queryValidator(".skip", []).isNonNegativeNumber(this.skipNumber).isInteger(this.skipNumber),
                        n = [...t(this.limitNumber, r), ...t(this.skipNumber, i)];
                    return Object.assign(e, {
                        invalidArguments: n
                    })
                }
                _queryValidator(e, t = this.invalidArguments) {
                    return new Z(e, t)
                }
            }

            function K(e, t) {
                const r = ((0, i.isString)(t) ? [] : [l.collectionNameMustBeAString()]).concat(e);
                return r.length > 0 ? Promise.reject(d(l.queryValidations.queryInvalid(t, r))) : Promise.resolve()
            }

            function ee(e, t) {
                return new Y({
                    provider: e,
                    collectionName: t,
                    filterTree: {},
                    orderBy: void 0,
                    skipNumber: 0,
                    invalidArguments: [],
                    included: [],
                    projectedFields: []
                })
            }
            class te {
                constructor(e) {
                    this._executeQuery = e => this._pagingFunction.bind(e)(), this._withCalculatedSkip = (e, t) => (e.skipNumber = J(this.query, this.length, t), Promise.resolve(e)), e && (this._items = e.items, this._totalCount = e.totalCount, this._cursors = e.cursors, this._createdByCursor = e.createdByCursor, this._query = e.query, this._partialIncludes = e.partialIncludes, this._pagingFunction = e.pagingFunction, this._hasNext = e.hasNext, this.nextSkipNumber = J(this.query, this.length, !0), this.prevSkipNumber = J(this.query, this.length, !1))
                }
                get items() {
                    return this._items
                }
                get length() {
                    return this.items.length
                }
                get totalCount() {
                    return this._totalCount
                }
                get query() {
                    return this._query
                }
                get pageSize() {
                    return this._query.limitNumber
                }
                get totalPages() {
                    if (this.totalCount && this.pageSize) return Math.ceil(this.totalCount / this.pageSize);
                    if (0 === this.totalCount) return 0;
                    const e = this.query.skipNumber || 0;
                    return this.totalCount && this.length + e <= this.totalCount ? Math.ceil(this.totalCount / this.length) : void 0
                }
                get currentPage() {
                    if (0 === this.length) return;
                    const e = this.query.skipNumber || 0;
                    return this.totalCount <= 0 || e >= this.totalCount || void 0 === this.pageSize ? this.hasNext() ? Math.floor(e / this.length) : void 0 : Math.floor(e / this.pageSize)
                }
                get partialIncludes() {
                    return this._partialIncludes
                }
                next() {
                    return this.hasNext() ? Q(this.nextCursor) ? this._getNewCursorQuery(this.nextCursor, !0).then((e => this._executeQuery(e))).then((e => e._withTotalCount(this._totalCount))) : this._getNewQuery(!0).then((e => this._executeQuery(e))) : this._rejectNoNextPage()
                }
                prev() {
                    return this.hasPrev() ? Q(this.prevCursor) ? this._getNewCursorQuery(this.prevCursor, !1).then((e => this._executeQuery(e))).then((e => e._withTotalCount(this._totalCount))) : this._getNewQuery(!1).then((e => this._executeQuery(e))) : this._rejectNoPrevPage()
                }
                get nextCursor() {
                    return this._cursors && this._cursors.next
                }
                get prevCursor() {
                    return this._cursors && this._cursors.prev
                }
                hasNext() {
                    return this._hasNext
                }
                hasPrev() {
                    if (Q(this._createdByCursor) || this._cursors) return Q(this.prevCursor);
                    if (0 === (this.query.skipNumber || 0) || this.totalCount <= 0) return !1;
                    return J(this.query, this.length, !1) >= 0
                }
                toJSON() {
                    return {
                        currentPage: this.currentPage,
                        items: this.items,
                        length: this.length,
                        pageSize: this.pageSize,
                        partialIncludes: this.partialIncludes,
                        query: this.query,
                        totalCount: this.totalCount,
                        totalPages: this.totalPages
                    }
                }
                _getNewQuery(e) {
                    return this._withCalculatedSkip(new Y({
                        provider: this.query.provider,
                        collectionName: this.query.collectionName,
                        filterTree: this.query.filterTree,
                        orderBy: this.query.orderBy,
                        limitNumber: this.query.limitNumber,
                        included: this.query.included,
                        invalidArguments: [],
                        projectedFields: this.query.projectedFields
                    }), e)
                }
                _getNewCursorQuery(e, t) {
                    const r = new Y({
                        provider: this.query.provider,
                        collectionName: this.query.collectionName,
                        filterTree: {},
                        limitNumber: this.query.limitNumber,
                        invalidArguments: [],
                        cursor: e,
                        included: this.query.included,
                        projectedFields: this.query.projectedFields
                    });
                    return this._withCalculatedSkip(r, t)
                }
                _withTotalCount(e) {
                    return this._totalCount = e, this
                }
                _rejectNoPrevPage() {
                    return Promise.reject(d(l.queryValidations.noPrevPage(this.query.collectionName)))
                }
                _rejectNoNextPage() {
                    return Promise.reject(d(l.queryValidations.noNextPage(this.query.collectionName)))
                }
            }
            const re = (e = class {}) => class extends e {
                constructor(e = {}) {
                    super(e), this.groupByTree = e.groupByTree, this.invalidArguments = e.invalidArguments || []
                }
                sum(e, t) {
                    const [r] = this._groupValidator(".sum").arityIsAtLeastOne(arguments).typeIsString(e).validateAndAggregate();
                    return this._addAccumulator("sum", e, t, r)
                }
                avg(e, t) {
                    const [r] = this._groupValidator(".avg").arityIsAtLeastOne(arguments).typeIsString(e).validateAndAggregate();
                    return this._addAccumulator("avg", e, t, r)
                }
                min(e, t) {
                    const [r] = this._groupValidator(".min").arityIsAtLeastOne(arguments).typeIsString(e).validateAndAggregate();
                    return this._addAccumulator("min", e, t, r)
                }
                max(e, t) {
                    const [r] = this._groupValidator(".max").arityIsAtLeastOne(arguments).typeIsString(e).validateAndAggregate();
                    return this._addAccumulator("max", e, t, r)
                }
                count() {
                    const [e] = this._groupValidator(".count").arityIsZero(arguments).validateAndAggregate(), t = (0, i.clone)(this.groupByTree) || {
                        _id: ae()
                    };
                    return t.count = {
                        $sum: 1
                    }, this._copy(t, e)
                }
                _addAccumulator(e, t, r, n) {
                    const s = (0, i.clone)(this.groupByTree) || {
                            _id: ae()
                        },
                        a = r || t + ((o = e).charAt(0).toUpperCase() + o.slice(1));
                    var o;
                    const l = {};
                    return l[`$${e}`] = `$${t}`, s[a] = l, this._copy(s, n)
                }
                _copy(e, t) {
                    return new this.constructor({ ...this,
                        groupByTree: e,
                        invalidArguments: t
                    })
                }
                _groupValidator(e) {
                    return new ne(e, this.invalidArguments)
                }
            };
            class ie extends(re()) {
                _build() {
                    return function(e) {
                        if (e.length > 0) throw d(l.groupBuilderInvalid(e))
                    }(this.invalidArguments), this.groupByTree
                }
            }
            class ne extends f {
                constructor(e, t) {
                    super(t), this.operatorName = e
                }
                typeIsString(e) {
                    return this.addValidation((() => (0, i.isString)(e)), (() => l.filterValidations.typeIsString(this.operatorName, e)))
                }
            }

            function se(...e) {
                const t = ae(...e);
                return new ie({
                    groupByTree: {
                        _id: t
                    }
                })
            }

            function ae(...e) {
                if (1 === e.length) return `$${e}`;
                if (e.length > 1) {
                    const t = {};
                    return e.forEach((e => t[e] = `$${e}`)), t
                }
                return "0"
            }
            class oe extends(L(re())) {
                constructor(e = {}) {
                    super(e), this.provider = e.provider, this.collectionName = e.collectionName, this.filterTree = e.filterTree, this.havingTree = e.havingTree, this.skipNumber = e.skipNumber || 0, this.limitNumber = e.limitNumber, this.cursor = e.cursor, this.invalidArguments = e.invalidArguments || []
                }
                filter(e) {
                    const [t] = this._aggregateValidator(".filter").arityIsOne(arguments).filterIsNotSet(this).filterBuilder(e).validateAndAggregate();
                    return new oe({
                        provider: this.provider,
                        collectionName: this.collectionName,
                        filterTree: e.filterTree,
                        groupByTree: this.groupByTree,
                        havingTree: this.havingTree,
                        skipNumber: this.skipNumber,
                        limitNumber: this.limitNumber,
                        cursor: this.cursor,
                        orderBy: this.orderBy,
                        invalidArguments: t.concat(e.invalidArguments)
                    })
                }
                group(...e) {
                    let t = (0, i.clone)(this.groupByTree);
                    const [r] = this._aggregateValidator(".group").arityIsAtLeastOne(arguments).groupIsNotSet(t).validateAndAggregate();
                    return t ? "0" === t._id && (t = { ...t,
                        _id: ae(...e)
                    }) : t = {
                        _id: ae(...e)
                    }, new oe({
                        provider: this.provider,
                        collectionName: this.collectionName,
                        filterTree: this.filterTree,
                        groupByTree: t,
                        havingTree: this.havingTree,
                        skipNumber: this.skipNumber,
                        limitNumber: this.limitNumber,
                        cursor: this.cursor,
                        orderBy: this.orderBy,
                        invalidArguments: r
                    })
                }
                having(e) {
                    const [t] = this._aggregateValidator(".having").arityIsOne(arguments).havingIsNotSet(this).filterBuilder(e).validateAndAggregate();
                    return new oe({
                        provider: this.provider,
                        collectionName: this.collectionName,
                        filterTree: this.filterTree,
                        groupByTree: this.groupByTree,
                        havingTree: e.filterTree,
                        skipNumber: this.skipNumber,
                        limitNumber: this.limitNumber,
                        cursor: this.cursor,
                        orderBy: this.orderBy,
                        invalidArguments: t.concat(e.invalidArguments)
                    })
                }
                skip(e) {
                    const [t] = this._aggregateValidator(".skip").arityIsOne(arguments).isNonNegativeNumber(e).isInteger(e).validateAndAggregate();
                    return new oe({
                        provider: this.provider,
                        collectionName: this.collectionName,
                        filterTree: this.filterTree,
                        groupByTree: this.groupByTree,
                        havingTree: this.havingTree,
                        skipNumber: e,
                        limitNumber: this.limitNumber,
                        cursor: this.cursor,
                        orderBy: this.orderBy,
                        invalidArguments: t
                    })
                }
                limit(e) {
                    const [t] = this._aggregateValidator(".limit").arityIsOne(arguments).isPositiveNumber(e).isInteger(e).validateAndAggregate();
                    return new oe({
                        provider: this.provider,
                        collectionName: this.collectionName,
                        filterTree: this.filterTree,
                        groupByTree: this.groupByTree,
                        havingTree: this.havingTree,
                        skipNumber: this.skipNumber,
                        limitNumber: e,
                        cursor: this.cursor,
                        orderBy: this.orderBy,
                        invalidArguments: t
                    })
                }
                run(e) {
                    const t = this,
                        r = this._buildPipeline();
                    return (i = this.invalidArguments, n = this.collectionName, i.length > 0 ? Promise.reject(d(l.aggregateValidations.aggregateInvalid(n, i))) : Promise.resolve()).then((() => N().options(e).validateAndReject())).then((() => this.provider.runAggregate(this.collectionName, r, this.limitNumber, e, this.cursor))).then((({
                        items: e,
                        hasNext: r,
                        cursors: i
                    }) => new ce({
                        items: e,
                        hasNext: r,
                        aggregate: t,
                        pageSize: e.length,
                        cursors: i,
                        createdByCursor: this.cursor
                    })));
                    var i, n
                }
                _buildPipeline() {
                    return [this.filterTree ? {
                        $match: this.filterTree
                    } : null, this.groupByTree ? {
                        $group: this.groupByTree
                    } : null, this.groupByTree ? {
                        $project: le(this.groupByTree)
                    } : null, this.havingTree ? {
                        $match: this.havingTree
                    } : null, this.orderBy.length > 0 ? {
                        $sort: this.orderBy
                    } : null, {
                        $skip: this.skipNumber
                    }].filter((e => null !== e))
                }
                _aggregateValidator(e) {
                    return new he(e, this.invalidArguments)
                }
            }

            function le(e) {
                const t = Object.keys(e).map((e => ({
                    [e]: 1
                })));
                return (0, i.isObject)(e._id) ? t.push(function(e) {
                    const t = Object.keys(e),
                        r = t.map((e => ({
                            [e]: `$_id.${e}`
                        })));
                    return Object.assign({}, ...r)
                }(e._id)) : (0, i.isString)(e._id) && "0" !== e._id && t.push({
                    [e._id.substr(1)]: "$_id"
                }), Object.assign({}, ...t)
            }

            function ue(e, t, r, i) {
                return new oe({
                    provider: e,
                    collectionName: t,
                    cursor: i,
                    limitNumber: r
                })
            }
            class ce {
                constructor(e) {
                    e && (this._items = e.items, this._hasNext = e.hasNext, this._aggregate = e.aggregate, this._pageSize = e.pageSize, this._cursors = e.cursors, this._createdByCursor = e.createdByCursor)
                }
                get items() {
                    return this._items
                }
                hasNext() {
                    return this._hasNext
                }
                hasPrev() {
                    return Q(this._createdByCursor) || this._cursors ? Q(this.prevCursor) : this._aggregate.skipNumber > 0
                }
                get length() {
                    return this._items.length
                }
                next() {
                    if (!this.hasNext()) return this._rejectNoNextPage();
                    let e;
                    if (Q(this.nextCursor)) e = this._getNewCursorAggregate(this.nextCursor);
                    else {
                        const t = J(this._aggregate, this.length, !0);
                        e = this._aggregate.skip(t)
                    }
                    return e.run()
                }
                prev() {
                    if (!this.hasPrev()) return this._rejectNoPrevPage();
                    let e;
                    return e = Q(this.prevCursor) ? this._getNewCursorAggregate(this.prevCursor) : this._aggregate.skip(Math.max(0, this._aggregate.skipNumber - this._aggregate.limitNumber)), e.run()
                }
                get nextCursor() {
                    return this._cursors && this._cursors.next
                }
                get prevCursor() {
                    return this._cursors && this._cursors.prev
                }
                _getNewCursorAggregate(e) {
                    const t = this._aggregate;
                    return ue(t.provider, t.collectionName, t.limitNumber, e)
                }
                _rejectNoPrevPage() {
                    return Promise.reject(d(l.queryValidations.noPrevPage(this._aggregate.collectionName)))
                }
                _rejectNoNextPage() {
                    return Promise.reject(d(l.queryValidations.noNextPage(this._aggregate.collectionName)))
                }
            }
            const de = 9007199254740991;
            class he extends f {
                constructor(e, t) {
                    super(t), this.operatorName = e
                }
                filterBuilder(e) {
                    return this.addValidation((() => "FilterBuilder" === e.constructorName), (() => l.aggregateValidations.filterMustBeBuilder(this.operatorName)))
                }
                filterIsNotSet(e) {
                    return this.addValidation((() => void 0 === e.filterTree), (() => l.aggregateValidations.filterIsAlreadySet(this.operatorName)))
                }
                havingIsNotSet(e) {
                    return this.addValidation((() => void 0 === e.havingTree), (() => l.aggregateValidations.filterIsAlreadySet(this.operatorName)))
                }
                groupIsNotSet(e) {
                    return this.addValidation((() => function(e) {
                        return !e || "0" === e._id
                    }(e)), (() => l.aggregateValidations.groupIsAlreadySet(this.operatorName)))
                }
                _isNumber(e, t) {
                    return this.addValidation((() => (0, i.isNumber)(t)), (() => l.queryValidations.isNumber(this.operatorName, e, t)))
                }
                isPositiveNumber(e) {
                    return this._isNumber("positive", e).addValidation((() => !Number.isNaN(e) && e > 0), (() => l.queryValidations.isPositiveNumber(this.operatorName, e)))
                }
                isNonNegativeNumber(e) {
                    return this._isNumber("non-negative", e).addValidation((() => !Number.isNaN(e) && e >= 0), (() => l.queryValidations.isNonNegativeNumber(this.operatorName, e)))
                }
                isInteger(e) {
                    return this.addValidation((() => !Number.isNaN(e) && Number.isFinite(e) && Number.isInteger(e) && e < de && e > -9007199254740991), (() => l.queryValidations.isInteger(this.operatorName, e)))
                }
            }
            class pe extends(L()) {
                _build() {
                    return this.getSortModel()
                }
            }
            class me {
                constructor(e) {
                    if (!e) return;
                    this._provider = e.provider, this._collectionName = e.collectionName, this._referenceAttribute = e.referenceAttribute, this._holdingItemId = e.holdingItemId, this._items = e.items, this._totalCount = e.totalCount, this._options = e.options;
                    const {
                        skip: t = 0,
                        limit: r
                    } = e.options || {};
                    this._skip = t, this._limit = r, this._cursors = e.cursors, this._createdByCursor = e.createdByCursor, this._hasNext = e.hasNext
                }
                get items() {
                    return this._items
                }
                get totalCount() {
                    return this._totalCount
                }
                get nextCursor() {
                    return this._cursors && this._cursors.next
                }
                get prevCursor() {
                    return this._cursors && this._cursors.prev
                }
                hasNext() {
                    return this._hasNext
                }
                hasPrev() {
                    return Q(this._createdByCursor) || this._cursors ? Q(this.prevCursor) : this._skip > 0
                }
                next() {
                    return this.hasNext() ? Q(this.nextCursor) ? this._getNewCursorQuery(this.nextCursor)._fetch().then((e => e._withTotalCount(this._totalCount))) : this._withChangedSkip(!0)._fetch() : this._rejectNoNextPage()
                }
                prev() {
                    return this.hasPrev() ? Q(this.prevCursor) ? this._getNewCursorQuery(this.prevCursor)._fetch().then((e => e._withTotalCount(this._totalCount))) : this._withChangedSkip(!1)._fetch() : this._rejectNoPrevPage()
                }
                _rejectNoPrevPage() {
                    return Promise.reject(d(l.queryValidations.noPrevPage(this._collectionName)))
                }
                _rejectNoNextPage() {
                    return Promise.reject(d(l.queryValidations.noNextPage(this._collectionName)))
                }
                _withChangedSkip(e) {
                    const t = J({
                        skipNumber: this._skip,
                        limitNumber: this._limit
                    }, this._items.length, e);
                    return ge({
                        items: this._items,
                        totalCount: this._totalCount,
                        pagingMetadata: new H({
                            total: this._totalCount
                        })
                    }, this._provider, this._collectionName, this._holdingItemId, this._referenceAttribute, { ...this._options,
                        skip: t,
                        limit: this._limit
                    })
                }
                _getNewCursorQuery(e) {
                    return ge({}, this._provider, this._collectionName, "", this._referenceAttribute, {
                        cursor: e,
                        limit: this._limit,
                        omitTotalCount: !0
                    })
                }
                _fetch() {
                    return this._provider.queryReferenced(this._collectionName, this._holdingItemId, this._referenceAttribute, this._options).then((e => ge(e, this._provider, this._collectionName, this._holdingItemId, this._referenceAttribute, this._options)))
                }
                _withTotalCount(e) {
                    return this._totalCount = e, this
                }
            }

            function ge(e, t, r, i, n, s) {
                const {
                    items: a,
                    totalCount: o,
                    pagingMetadata: l
                } = e, {
                    total: u,
                    cursors: c,
                    hasNext: d = !1
                } = l || new H;
                return new me({
                    provider: t,
                    collectionName: r,
                    referenceAttribute: n,
                    holdingItemId: i,
                    items: a,
                    totalCount: u || o,
                    options: s,
                    cursors: c,
                    createdByCursor: s ? .cursor,
                    hasNext: d
                })
            }

            function fe(e, t) {
                if (!e) return !1;
                if (Array.isArray(e)) return e.some((e => fe(e, t)));
                if ("object" == typeof e) {
                    return Object.keys(e).some((r => t(r) || fe(e[r], t)))
                }
                return !1
            }
            class ve {
                constructor(e) {
                    this.get = ye(((e, t, r, i) => N().arity("get", e, 2, 3).collectionName(t).itemId(r).options(i).validateAndReject().then((() => this.provider.get(t, r, i))).then(_e))), this.insert = ye(((e, t, r, i) => N().arity("insert", e, 2, 3).validateAndReject().then((() => Ne(this.provider, "insert")(t, r, i))))), this.query = e => ee(this.provider, e), this.filter = () => M(), this.sort = () => new pe(void 0), this.find = (e, t, r, i, n, s, a, o) => {
                        const l = ee(this.provider, e);
                        l.filterTree = t, l.orderBy = r, l.skipNumber = i, l.limitNumber = n, l.included = a;
                        const u = { ...s,
                            omitTotalCount: o
                        };
                        return l.find(u)
                    }, this.remove = ye(((e, t, r, i) => N().arity("remove", e, 2, 3).collectionName(t).itemId(r).options(i).validateAndReject().then((() => this.provider.remove(t, r, i))).then(_e))), this.truncate = ye(((e, t, r) => N().arity("truncate", e, 1, 2).collectionName(t).options(r).validateAndReject().then((() => this.provider.truncate(t, r))).then(_e))), this.bulkRemove = ye(((e, t, r, i) => N().arity("bulkRemove", e, 2, 3).collectionName(t).itemIds(r, t).options(i).validateAndReject().then((() => this.provider.bulkRemove(t, r, i))).then(_e).then((e => {
                        const t = e.errors.map((e => new p(e.message, e.code, e.item, e.name, e.originalIndex)));
                        return { ...e,
                            errors: t
                        }
                    })))), this.save = ye(((e, t, r, i) => N().arity("save", e, 2, 3).validateAndReject().then((() => Ne(this.provider, "save")(t, r, i))))), this.update = ye(((e, t, r, i) => N().arity("update", e, 2, 3).validateAndReject().then((() => Ne(this.provider, "update")(t, r, i))))), this.fetch = ye(((e, t, r, i, n) => N().arity("fetch", e, 3, 4).isNonEmptyString(r, "cursor").validateAndReject().then((() => this.provider.find(t, void 0, void 0, void 0, i, n, void 0, !0, r))).then((e => function(e, t, r, i, n, s) {
                        const {
                            items: a,
                            totalCount: o,
                            partialIncludes: l,
                            pagingMetadata: u
                        } = e, {
                            cursors: c,
                            hasNext: d = !1
                        } = u || new H, h = ee(t, r).limit(i), p = Q(c ? .next) || Q(c ? .prev) ? { ...n,
                            omitTotalCount: !0
                        } : n;
                        return new te({
                            createdByCursor: s,
                            items: a,
                            totalCount: o,
                            partialIncludes: l,
                            cursors: c,
                            query: h,
                            pagingFunction() {
                                return this.find(p)
                            },
                            hasNext: d
                        })
                    }(e, this.provider, t, i, n))))), this.fetchReferenced = ye(((e, t, r, i, n) => N().arity("fetchReferenced", e, 3, 4).isNonEmptyString(r, "cursor").validateAndReject().then((() => {
                        const e = { ...n
                        };
                        return e.limit = i, e.cursor = r, e.omitTotalCount = !0, this.provider.queryReferenced(t, void 0, void 0, e).then((r => ge(r, this.provider, t, void 0, void 0, e)))
                    })))), this.fetchAggregate = ye(((e, t, r, i, n) => N().arity("fetchAggregate", e, 3, 4).isNonEmptyString(r, "cursor").validateAndReject().then((() => ue(this.provider, t, i, r).run(n))))), this.queryReferenced = ye(((e, t, r, i, n) => N().arity("queryReferenced", e, 3, 4).referenceParameter(r).validateAndReject().then((() => {
                        const e = be(r),
                            s = n || {};
                        return this.provider.queryReferenced(t, e, i, s).then((r => ge(r, this.provider, t, e, i, n)))
                    })))), this.insertReference = ye(((e, t, r, n, s, a) => {
                        let o, l, u;
                        return (0, i.isArray)(r) ? (l = r, o = n, u = () => N().arity("insertReference", e, 2, 3).references(l).validateAndReject()) : (l = Ie(s).map((e => ({
                            relationshipName: r,
                            left: n,
                            right: e
                        }))), o = a, u = () => N().arity("insertReference", e, 4, 5).references(l).validateAndReject()), u().then((() => this.provider.insertReferences(t, (e => e.map((e => ({
                            relationshipName: e.relationshipName,
                            left: be(e.left),
                            right: be(e.right)
                        }))))(l), o)))
                    })), this.replaceReferences = ye(((e, t, r, i, n, s) => (n = Ie(n).map(be), i = be(i), N().arity("replaceReferences", e, 4, 5).referenceParameter(i).referenceParameters(n).validateAndReject().then((() => this.provider.replaceReferences(t, {
                        relationshipName: r,
                        left: i
                    }, n.map((e => ({
                        relationshipName: r,
                        right: e,
                        left: i
                    }))), s)))))), this.removeReference = ye(((e, t, r, i, n, s) => (n = Ie(n).map(be), i = be(i), N().arity("removeReference", e, 4, 5).referenceParameter(i).referenceRemoveParameters(n).validateAndReject().then((() => 1 === n.length ? this.provider.removeReference(t, r, i, n[0], s) : this.provider.removeReferences(t, n.map((e => ({
                        relationshipName: r,
                        right: e,
                        left: i
                    }))), s)))))), this.isReferenced = ye(((e, t, r, i, n, s) => N().arity("isReferenced", e, 4, 5).referenceParameter(i).referenceParameter(n).validateAndReject().then((() => this.provider.isReferenced(t, r, be(i), be(n), s))))), this.bulkInsert = ye(((e, t, r, i) => N().arity("bulkInsert", e, 2, 3).validateAndReject().then((() => this.provider.bulkInsert(t, r, i))).then((e => {
                        const t = e.errors.map((e => new p(e.message, e.code, e.item, e.name, e.originalIndex)));
                        return { ...e,
                            errors: t
                        }
                    })))), this.bulkSave = ye(((e, t, r, i) => N().arity("bulkSave", e, 2, 3).validateAndReject().then((() => this.provider.bulkSave(t, r, i))).then((e => {
                        const t = e.errors.map((e => new p(e.message, e.code, e.item, e.name, e.originalIndex)));
                        return { ...e,
                            errors: t
                        }
                    })))), this.bulkUpdate = ye(((e, t, r, i) => N().arity("bulkUpdate", e, 2, 3).validateAndReject().then((() => this.provider.bulkUpdate(t, r, i))).then((e => {
                        const t = e.errors.map((e => new p(e.message, e.code, e.item, e.name, e.originalIndex)));
                        return { ...e,
                            errors: t
                        }
                    })))), this.getSchema = () => this.provider.getSchema(), this.group = (...e) => se(...e), this.aggregate = e => function(e, t) {
                        return new oe({
                            provider: e,
                            collectionName: t
                        })
                    }(this.provider, e), this.provider = e
                }
                get wixData() {
                    return this
                }
            }

            function ye(e) {
                return function(...t) {
                    return e(arguments, ...t)
                }
            }

            function Ne(e, t, r = !1) {
                return (i, n, s) => {
                    return N().collectionName(i).item(n, i, r).options(s).validateAndReject().then((() => function(e) {
                        const t = fe(e, (e => e.startsWith("$"))),
                            r = fe(e, (e => e.includes(".")));
                        t && console.error("Data inserted contains field name prefixed with symbol '$'. It is not recommended to use such field names as it will not work with some data operations.");
                        r && console.warn("Data inserted contains field name containing symbol '.'. It is not recommended to use such field names as it will not work with some data operations.")
                    }(n))).then((() => e[t](i, n, s))).then(_e).then((a = n, function(e) {
                        if (e) {
                            for (const t in e) e.hasOwnProperty(t) && (a.hasOwnProperty(t) && !0 !== Object.getOwnPropertyDescriptor(a, t) ? .writable || (a[t] = e[t]));
                            for (const t in a) e.hasOwnProperty(t) || delete a[t];
                            return a
                        }
                    }));
                    var a
                }
            }

            function _e(e) {
                return e && e.hasOwnProperty("item") ? e.item : e
            }

            function Ie(e) {
                return (0, i.isArray)(e) ? e : [e]
            }

            function be(e) {
                return (0, i.isObject)(e) ? e._id : e
            }
            const {
                getSchemaNamespace: Ae
            } = r(44704);

            function Se(e) {
                return "WDE0020" === e || "WDE0024" === e ? u.ValidationError : "WDE0025" === e ? u.SchemaDoesNotExist : "WDE0026" === e ? u.CollectionDeleted : "WDE0027" === e ? u.PermissionDenied : "WDE0052" === e ? u.SiteInTemplateMode : "WDE0073" === e ? u.ItemDoesNotExist : "WDE0074" === e ? u.ItemAlreadyExists : "WDE0022" === e || "WDE0007" === e ? u.ValidationError : e
            }
            const Oe = "WDE0078",
                $e = "WDE0109",
                je = "WDE0080",
                De = e => t => e("platformized-data-response", {
                    requestId: t.headers ? .["x-wix-request-id"]
                })((() => (0, i.parseDates)(t.data))),
                Ee = e => t => e("wix-data-error-response", {
                    responseData: t ? .response ? .data,
                    status: t ? .response ? .status,
                    requestId: t ? .response ? .headers ? .["x-wix-request-id"],
                    error: t ? .response ? t.response : t
                })((() => Promise.resolve())).then((() => {
                    if (function(e) {
                            return 413 === e ? .response ? .status
                        }(t)) return c(l.payloadIsTooLarge(), $e);
                    const e = t ? .response ? .data;
                    return we(e) ? function(e) {
                        const t = e.details.applicationError.data;
                        if (t ? .jsErrorValue) {
                            const {
                                name: e,
                                message: r,
                                code: i
                            } = t.jsErrorValue, n = new Error(r);
                            return n.name = e, n.code = i, n
                        }
                        return t ? .value
                    }(e) : function(e) {
                        return e ? .details ? .applicationError
                    }(e) ? Pe(e) : function(e) {
                        return e ? .details ? .validationError
                    }(e) ? function(e) {
                        const t = (e.details.validationError.fieldViolations || []).map((e => `${e.field}: ${e.description}`)),
                            r = [e.message, ...t].join("\n");
                        return c(r, je, e.details)
                    }(e) : function(e) {
                        return (e ? .message || "").startsWith("WDE")
                    }(t) ? t : function(e) {
                        const t = e => e instanceof Error ? `${e}` : JSON.stringify(e),
                            r = e ? .response ? .headers ? .["x-wix-request-id"],
                            i = e ? .response ? .status,
                            n = e ? .response ? .statusText,
                            s = e ? .response ? e.response : e;
                        let a = i ? `${i}` : "";
                        return a += n ? `(${n})` : "", a += r ? ` ${r}` : "", a = a || t(e), c(l.serverInvalidResponse(a), u.UnknownError, s)
                    }(t)
                })).then((e => Promise.reject(e)));

            function we(e) {
                return e ? .details ? .applicationError ? .code === Oe
            }
            const Pe = e => {
                const t = Se(e.details.applicationError.code);
                return c(e.details.applicationError.description, t, e.details)
            };
            const Te = e => t => Ce(e)({
                    message: t.itemMetadata.error.description,
                    details: {
                        applicationError: {
                            code: t.itemMetadata.error.code,
                            description: t.itemMetadata.error.description
                        }
                    },
                    originalIndex: t.itemMetadata.originalIndex
                }),
                Ce = e => t => {
                    const {
                        message: r,
                        code: i,
                        name: n
                    } = function(e) {
                        const t = e.details ? .applicationError;
                        if (we(e)) {
                            const e = t.data ? .jsErrorValue;
                            if (e) return {
                                message: e.message,
                                code: e.code,
                                name: e.name
                            };
                            const r = t.data ? .value;
                            return "string" == typeof r ? {
                                message: r
                            } : {}
                        }
                        return {
                            code: Se(t ? .code) || u.UnknownError,
                            message: t ? .description || e.message,
                            name: "Error"
                        }
                    }(t);
                    return {
                        message: r,
                        code: i,
                        name: n,
                        originalIndex: t.originalIndex,
                        item: e[t.originalIndex]
                    }
                };
            const xe = () => e => e();

            function We(e) {
                const t = "object" == typeof e ? Object.keys(e).filter((t => "object" == typeof e[t] && "_id" !== t)).map((t => {
                        const r = e[t],
                            i = (e => {
                                switch (Object.keys(e)[0]) {
                                    case "$sum":
                                        return "sum";
                                    case "$min":
                                        return "min";
                                    case "$avg":
                                        return "average";
                                    case "$max":
                                        return "max";
                                    default:
                                        return ""
                                }
                            })(r),
                            n = (e => {
                                const t = Object.values(e)[0];
                                return "string" == typeof t && t.startsWith("$") ? t.substring(1) : t
                            })(r),
                            s = {
                                resultFieldName: t
                            };
                        return "sum" === i && 1 === n ? s.itemCount = {} : s[i] = {
                            itemFieldName: n
                        }, s
                    })) : [],
                    r = {
                        groupingFields: (e => "object" == typeof e ? "object" == typeof e._id ? Object.keys(e._id) : "0" === e._id ? [] : [e._id.substring(1)] : [])(e),
                        operations: t
                    };
                return r
            }
            const ke = e => "object" == typeof e && null !== e && "get" in e && "function" == typeof e.get;
            class Re {
                constructor({
                    cloudDataUrl: e = "/_api/cloud-data",
                    gridAppId: t,
                    segment: r,
                    httpClient: i,
                    authHeader: n,
                    traceWith: s = xe,
                    allowGetRequests: a = !1,
                    shouldUseDataItemService: o = Promise.resolve(!1)
                }) {
                    this.cloudDataUrl = e, this.gridAppId = t, this.segment = r, this.httpClientProvider = "function" == typeof i ? i : () => i, this.traceWith = s, this.authHeader = n, this.allowGetRequests = a, this.shouldUseDataItemService = o
                }
                _unwarpDataItems(e) {
                    return e.map((e => e.data))
                }
                _unwrapDataItem(e) {
                    return e && e.hasOwnProperty("dataItem") && e.dataItem.hasOwnProperty("data") ? {
                        item: e.dataItem.data
                    } : e
                }
                insert(e, t, r) {
                    return this._traceWith("platformized-provider-insert", {
                        collectionName: e
                    })((() => N().collectionName(e).item(t, e, !1).options(r).validateAndReject().then((() => this.shouldUseDataItemService)).then((i => i ? this._call("/v2/items", {
                        dataCollectionId: e,
                        dataItem: {
                            id: t._id,
                            dataCollectionId: e,
                            data: t
                        },
                        includeReferencedItems: r && r.includeReferences,
                        options: this._optionsWithPluginsItemService(r)
                    }, !1, i).then(this._unwrapDataItem) : this._call("/v1/wix-data/collections/insert", {
                        collectionName: e,
                        item: t,
                        options: this._optionsWithPlugins(r)
                    })))))
                }
                update(e, t, r) {
                    return this._traceWith("platformized-provider-update", {
                        collectionName: e
                    })((() => N().collectionName(e).item(t, e, !1).options(r).validateAndReject().then((() => this.shouldUseDataItemService)).then((i => i ? this._call("/v2/items/update", {
                        dataCollectionId: e,
                        dataItem: {
                            id: t._id,
                            dataCollectionId: e,
                            data: t
                        },
                        includeReferencedItems: r && r.includeReferences,
                        options: this._optionsWithPluginsItemService(r)
                    }, !1, i).then(this._unwrapDataItem) : this._call("/v1/wix-data/collections/update", {
                        collectionName: e,
                        item: t,
                        options: this._optionsWithPlugins(r)
                    })))))
                }
                save(e, t, r) {
                    return this._traceWith("platformized-provider-save", {
                        collectionName: e
                    })((() => N().collectionName(e).item(t, e, !1).options(r).validateAndReject().then((() => this.shouldUseDataItemService)).then((i => i ? this._call("/v2/items/save", {
                        dataCollectionId: e,
                        dataItem: {
                            id: t._id,
                            dataCollectionId: e,
                            data: t
                        },
                        includeReferencedItems: r && r.includeReferences,
                        options: this._optionsWithPluginsItemService(r)
                    }, !1, i).then(this._unwrapDataItem) : this._call("/v1/wix-data/collections/save", {
                        collectionName: e,
                        item: t,
                        options: this._optionsWithPlugins(r)
                    })))))
                }
                truncate(e, t) {
                    return this._traceWith("platformized-provider-truncate", {
                        collectionName: e
                    })((() => N().collectionName(e).truncateOptions(t).validateAndReject().then((() => this.shouldUseDataItemService)).then((r => r ? this._call("/v2/items/truncate", {
                        dataCollectionId: e,
                        options: this._optionsWithPluginsItemService(t)
                    }, !1, r) : this._call("/v1/wix-data/collections/truncate", {
                        collectionName: e,
                        options: this._optionsWithPlugins(t)
                    }))).then((() => Promise.resolve(null)))))
                }
                remove(e, t, r) {
                    return this._traceWith("platformized-provider-remove", {
                        collectionName: e
                    })((() => N().collectionName(e).itemId(t).options(r).validateAndReject().then((() => this.shouldUseDataItemService)).then((i => i ? this._call("/v2/items/remove", {
                        dataCollectionId: e,
                        dataItemId: t,
                        options: this._optionsWithPluginsItemService(r)
                    }, !1, i).then(this._unwrapDataItem) : this._call("/v1/wix-data/collections/remove", {
                        collectionName: e,
                        itemId: t,
                        options: this._optionsWithPlugins(r)
                    }))).catch((e => e && e.code === u.ItemDoesNotExist ? Promise.resolve(null) : Promise.reject(e)))))
                }
                bulkRemove(e, t, r) {
                    return this._traceWith("platformized-provider-bulk-remove", {
                        collectionName: e
                    })((() => N().collectionName(e).itemIds(t, e).bulkRemoveOptions(r).validateAndReject().then((() => this.shouldUseDataItemService)).then((i => 0 === t.length ? {
                        removedItemIds: [],
                        removed: 0,
                        skipped: 0,
                        errors: []
                    } : i ? this._call("/v2/bulk/items/remove", {
                        dataCollectionId: e,
                        dataItemIds: t,
                        options: this._optionsWithPluginsItemService(r)
                    }, !1, !0).then((({
                        results: e
                    }) => {
                        const r = e.filter((e => e.itemMetadata.success)),
                            i = e.filter((e => !e.itemMetadata.success && "WDE0073" !== e.itemMetadata.error.code)),
                            n = r.map((e => e.itemMetadata.id));
                        return {
                            removedItemIds: n,
                            removed: n.length,
                            skipped: t.length - n.length - i.length,
                            errors: i.map(Te(t))
                        }
                    })) : this._call("/v1/wix-data/collections/bulk-remove", {
                        collectionName: e,
                        entries: t.map((e => ({
                            itemId: e
                        }))),
                        options: this._optionsWithPlugins(r)
                    }).then((e => {
                        const {
                            removedItemIds: r,
                            errors: i
                        } = e;
                        return {
                            removedItemIds: r,
                            removed: r.length,
                            skipped: t.length - r.length - i.length,
                            errors: i.map(Ce(t))
                        }
                    })))).catch((e => e && e.code === u.ItemDoesNotExist ? Promise.resolve(null) : Promise.reject(e)))))
                }
                get(e, t, r) {
                    return this._traceWith("platformized-provider-get", {
                        collectionName: e,
                        itemId: t
                    })((() => {
                        const i = r ? .fields || [];
                        return N().collectionName(e).itemId(t).options(r).validateAndReject().then((() => this.shouldUseDataItemService)).then((n => n ? this._call("/v2/items/get", {
                            dataCollectionId: e,
                            dataItemId: t,
                            options: this._optionsWithPluginsItemService(r),
                            fields: i
                        }, !1, n).then(this._unwrapDataItem) : this._call("/v1/wix-data/collections/get", {
                            collectionName: e,
                            itemId: t,
                            options: this._optionsWithPlugins(r)
                        }))).catch((e => e && e.code === u.ItemDoesNotExist ? Promise.resolve(null) : Promise.reject(e)))
                    }))
                }
                find(e, t, r, n, s, a, o, l, u, c) {
                    return this._traceWith("platformized-provider-find", {
                        collectionName: e
                    })((() => N().collectionName(e).options(a).validateAndReject().then((() => this._validateOrderBy(e, r))).then((() => this._validateFilter(e, t))).then((() => this.shouldUseDataItemService)).then((d => {
                        const h = this._getDataQuery(t, r, s, n, u, c);
                        return d ? this._call("/v2/items/query", {
                            dataCollectionId: e,
                            query: h,
                            options: this._optionsWithPluginsItemService(a),
                            includeReferencedItems: o,
                            returnTotalCount: !l
                        }, !0, !0).then((e => {
                            const {
                                dataItems: t,
                                pagingMetadata: r
                            } = e, n = this._unwarpDataItems(t), s = !!n.find((e => !(!(0, i.isArray)(o) || !o.find((t => {
                                const r = e[t];
                                return (0, i.isArray)(r) && r.length >= 50
                            })))));
                            return {
                                items: n,
                                partialIncludes: s,
                                totalCount: r.total,
                                pagingMetadata: r
                            }
                        })) : this._call("/v1/wix-data/collections/query", {
                            collectionName: e,
                            dataQuery: h,
                            options: this._optionsWithPlugins(a),
                            includeReferencedItems: o,
                            omitTotalCount: l
                        }, !0).then((({
                            items: e,
                            partialIncludes: t,
                            pagingMetadata: r
                        }) => ({
                            items: e,
                            partialIncludes: t,
                            totalCount: r.total,
                            pagingMetadata: r
                        })))
                    }))))
                }
                runAggregate(e, t, r, n, s) {
                    return this._traceWith("platformized-provider-aggregate", {
                        collectionName: e
                    })((() => N().collectionName(e).options(n).validateAndReject().then((() => this.shouldUseDataItemService)).then((a => {
                        const o = (0, i.toPlatformizedAggregate)(t);
                        return a ? this._call("/v2/items/aggregate", {
                            dataCollectionId: e,
                            initialFilter: o.preFilteringStep,
                            aggregation: We(o.processingStep),
                            finalFilter: o.postFilteringStep,
                            sort: this._platformizedSort(t),
                            options: this._optionsWithPluginsItemService(n),
                            ...this._getAggregatePaging(t, r, s)
                        }, !0, !0).then((e => {
                            const {
                                results: t,
                                pagingMetadata: {
                                    cursors: r,
                                    hasNext: i
                                }
                            } = e;
                            return {
                                items: t.map((e => {
                                    if ("object" == typeof e._id && 1 === Object.keys(e._id).length) {
                                        const t = e._id[Object.keys(e._id)[0]];
                                        e._id = t
                                    }
                                    return e
                                })),
                                hasNext: i,
                                cursors: r
                            }
                        })) : this._call("/v1/wix-data/collections/aggregate", {
                            collectionName: e,
                            initialFilter: o.preFilteringStep,
                            aggregation: o.processingStep,
                            finalFilter: o.postFilteringStep,
                            sort: this._platformizedSort(t),
                            options: this._optionsWithPlugins(n),
                            ...this._getAggregatePaging(t, r, s)
                        }).then((e => {
                            const {
                                items: t,
                                pagingMetadata: {
                                    cursors: r,
                                    hasNext: i
                                }
                            } = e;
                            return {
                                items: t,
                                hasNext: i,
                                cursors: r
                            }
                        }))
                    }))))
                }
                _optionsWithPluginsItemService(e) {
                    const t = e || {};
                    return t.showDrafts ? { ...t,
                        publishPluginOptions: {
                            showDraftItems: !0
                        }
                    } : t
                }
                _optionsWithPlugins(e) {
                    const t = e || {};
                    return t.showDrafts ? { ...t,
                        pluginOptions: {
                            showDrafts: !0
                        }
                    } : t
                }
                _platformizedSort(e) {
                    const t = e.find((e => e.hasOwnProperty("$sort")));
                    if (!t) return;
                    return t.$sort.map((e => {
                        const [t, r] = Object.entries(e)[0];
                        return {
                            fieldName: t,
                            order: "asc" === r ? 0 : 1
                        }
                    }))
                }
                _getDataQuery(e, t, r, i, n, s) {
                    return {
                        filter: e,
                        sort: t ? this._mapOrderToSort(t) : void 0,
                        ...this._getPaging(r, i, n),
                        fields: s
                    }
                }
                _getAggregatePaging(e, t, r) {
                    const i = e.find((e => e.hasOwnProperty("$skip"))),
                        n = void 0 !== i ? i.$skip : void 0;
                    return this._getPaging(t, n, r)
                }
                _getPaging(e, t, r) {
                    if (r && t > 0) throw c(l.cursorPagingDoesNotSupportSkip(), u.ValidationError);
                    return r ? {
                        cursorPaging: {
                            limit: e,
                            cursor: r
                        }
                    } : {
                        paging: {
                            offset: t,
                            limit: e
                        }
                    }
                }
                count(e, t, r) {
                    return this._traceWith("platformized-provider-count", {
                        collectionName: e
                    })((() => N().collectionName(e).options(r).validateAndReject().then((() => this._validateFilter(e, t))).then((() => this.shouldUseDataItemService)).then((i => i ? this._call("/v2/items/count", {
                        dataCollectionId: e,
                        filter: t,
                        options: this._optionsWithPluginsItemService(r)
                    }, !0, !0) : this._call("/v1/wix-data/collections/count", {
                        collectionName: e,
                        filter: t,
                        options: this._optionsWithPlugins(r)
                    })))))
                }
                _sortingFromOrder(e, t) {
                    const r = ((0, i.isArray)(e) ? e : []).find((e => e.hasOwnProperty(t))),
                        n = r && r.hasOwnProperty(t) ? r[t] : void 0;
                    return n ? n.toUpperCase() : n
                }
                distinct(e, t, r, i, n, s, a, o, l, u) {
                    return this._traceWith("platformized-provider-distinct", {
                        collectionName: e
                    })((() => N().collectionName(e).options(a).validateAndReject().then((() => this._validateOrderBy(e, r))).then((() => this._validateFilter(e, t))).then((() => this.shouldUseDataItemService)).then((c => {
                        const d = this._getDataQuery(t, r, s, n, o, l);
                        return c ? this._call("/v2/items/query-distinct-values", {
                            dataCollectionId: e,
                            fieldName: i,
                            filter: d.filter,
                            order: this._sortingFromOrder(r, i),
                            options: this._optionsWithPluginsItemService(a),
                            paging: d.paging,
                            cursorPaging: d.cursorPaging,
                            returnTotalCount: !u
                        }, !0, !0).then((({
                            distinctValues: e,
                            pagingMetadata: t
                        }) => ({
                            items: e,
                            totalCount: t.total,
                            pagingMetadata: t
                        }))) : this._call("/v1/wix-data/collections/distinct", {
                            collectionName: e,
                            dataQuery: d,
                            propertyName: i,
                            options: this._optionsWithPlugins(a),
                            omitTotalCount: u
                        }).then((({
                            items: e,
                            pagingMetadata: t
                        }) => ({
                            items: e,
                            totalCount: t.total,
                            pagingMetadata: t
                        })))
                    }))))
                }
                bulkInsert(e, t, r) {
                    return this._traceWith("platformized-provider-bulk-insert", {
                        collectionName: e
                    })((() => {
                        const i = (r || {}).overrideExisting;
                        return N().collectionName(e).items(t, e).bulkInsertOptions(r).validateAndReject().then((() => this.shouldUseDataItemService)).then((n => {
                            if (0 === t.length) return {
                                insertedItemIds: [],
                                inserted: 0,
                                errors: [],
                                skipped: 0,
                                updated: 0
                            };
                            if (n) {
                                const s = i ? "/v2/bulk/items/save" : "/v2/bulk/items/insert";
                                return this._call(s, {
                                    dataCollectionId: e,
                                    dataItems: t.map((t => ({
                                        id: t._id,
                                        dataCollectionId: e,
                                        data: t
                                    }))),
                                    options: this._optionsWithPluginsItemService(r)
                                }, !1, n).then((({
                                    results: e
                                }) => {
                                    const r = e.filter((e => e.itemMetadata.success)),
                                        n = r.map((e => e.itemMetadata.id)),
                                        s = r.filter((e => "INSERT" === e.action)).length,
                                        a = r.filter((e => "UPDATE" === e.action)).length,
                                        o = e.filter((e => !e.itemMetadata.success && "WDE0074" !== e.itemMetadata.error.code));
                                    return {
                                        insertedItemIds: n,
                                        inserted: s,
                                        skipped: i ? 0 : t.length - n.length - o.length,
                                        updated: a,
                                        errors: o.map(Te(t))
                                    }
                                }))
                            }
                            return this._call("/v1/wix-data/collections/bulk-insert", {
                                collectionName: e,
                                items: t,
                                options: this._optionsWithPlugins(r)
                            }).then((e => {
                                const {
                                    insertedItemIds: r,
                                    errors: n
                                } = e;
                                return {
                                    insertedItemIds: r,
                                    inserted: r.length,
                                    skipped: i ? 0 : t.length - r.length - n.length,
                                    updated: i ? t.length - r.length - n.length : 0,
                                    errors: n.map(Ce(t))
                                }
                            }))
                        }))
                    }))
                }
                bulkSave(e, t, r) {
                    return this._traceWith("platformized-provider-bulk-save", {
                        collectionName: e
                    })((() => N().collectionName(e).items(t, e).bulkInsertOptions(r).validateAndReject().then((() => this.shouldUseDataItemService)).then((i => 0 === t.length ? {
                        insertedItemIds: [],
                        updatedItemIds: [],
                        inserted: 0,
                        updated: 0,
                        skipped: 0,
                        errors: []
                    } : i ? this._call("/v2/bulk/items/save", {
                        dataCollectionId: e,
                        dataItems: t.map((t => ({
                            id: t._id,
                            dataCollectionId: e,
                            data: t
                        }))),
                        options: this._optionsWithPluginsItemService(r)
                    }, !1, !0).then((({
                        results: e
                    }) => {
                        const r = e.filter((e => e.itemMetadata.success)),
                            i = r.filter((e => "INSERT" === e.action)),
                            n = r.filter((e => "UPDATE" === e.action)),
                            s = i.map((e => e.itemMetadata.id)),
                            a = n.map((e => e.itemMetadata.id)),
                            o = e.filter((e => !e.itemMetadata.success));
                        return {
                            insertedItemIds: s,
                            updatedItemIds: a,
                            inserted: i.length,
                            skipped: t.length - s.length - a.length - o.length,
                            updated: n.length,
                            errors: o.map(Te(t))
                        }
                    })) : this._call("/v1/wix-data/collections/bulk-save", {
                        collectionName: e,
                        items: t,
                        options: this._optionsWithPlugins(r)
                    }).then((e => {
                        const {
                            insertedItemIds: r,
                            updatedItemIds: i,
                            errors: n
                        } = e;
                        return {
                            insertedItemIds: r,
                            updatedItemIds: i,
                            inserted: r.length,
                            skipped: t.length - r.length - i.length - n.length,
                            updated: i.length,
                            errors: n.map(Ce(t))
                        }
                    }))))))
                }
                bulkUpdate(e, t, r) {
                    return this._traceWith("platformized-provider-bulk-update", {
                        collectionName: e
                    })((() => N().collectionName(e).items(t, e).bulkUpdateOptions(r).validateAndReject().then((() => this.shouldUseDataItemService)).then((i => 0 === t.length ? {
                        updatedItemIds: [],
                        inserted: 0,
                        skipped: 0,
                        updated: 0,
                        errors: []
                    } : i ? this._call("/v2/bulk/items/update", {
                        dataCollectionId: e,
                        dataItems: t.map((t => ({
                            id: t._id,
                            dataCollectionId: e,
                            data: t
                        }))),
                        options: this._optionsWithPluginsItemService(r)
                    }, !1, !0).then((({
                        results: e
                    }) => {
                        const r = e.filter((e => e.itemMetadata.success)).filter((e => "UPDATE" === e.action)),
                            i = r.map((e => e.itemMetadata.id)),
                            n = e.filter((e => !e.itemMetadata.success && "WDE0073" != e.itemMetadata.error.code));
                        return {
                            updatedItemIds: i,
                            inserted: 0,
                            skipped: t.length - i.length - n.length,
                            updated: r.length,
                            errors: n.map(Te(t))
                        }
                    })) : this._call("/v1/wix-data/collections/bulk-update", {
                        collectionName: e,
                        items: t,
                        options: this._optionsWithPlugins(r)
                    }).then((e => {
                        const {
                            updatedItemIds: r,
                            errors: i
                        } = e;
                        return {
                            updatedItemIds: r,
                            inserted: 0,
                            skipped: t.length - r.length - i.length,
                            updated: r.length,
                            errors: i.map(Ce(t))
                        }
                    }))))))
                }
                queryReferenced(e, t, r, i) {
                    return this._traceWith("platformized-provider-query-referenced", {
                        collectionName: e,
                        order: i.order,
                        skip: i.skip,
                        limit: i.limit,
                        cursorExists: i.cursor ? "true" : "false"
                    })((() => {
                        const n = ((i = i || {}).order || "ASC").toUpperCase(),
                            s = i.skip || 0,
                            a = i.limit || 50,
                            o = i.cursor,
                            l = i.omitTotalCount || !1,
                            u = i ? .fields || [];
                        return N().collectionName(e).options(i).validateAndReject().then((() => this.shouldUseDataItemService)).then((c => c ? this._call("/v2/items/query-referenced", {
                            dataCollectionId: e,
                            referringItemId: t,
                            referringItemFieldName: r,
                            order: n,
                            ...this._getPaging(a, s, o),
                            returnTotalCount: !l,
                            options: this._optionsWithPluginsItemService(i),
                            fields: u
                        }, !0, !0).then((({
                            results: e,
                            pagingMetadata: t
                        }) => ({
                            items: e.map((e => e.dataItem.data)),
                            totalCount: t.total,
                            pagingMetadata: t
                        }))) : this._call("/v1/wix-data/collections/query-referenced", {
                            collectionName: e,
                            propertyName: r,
                            referringItemId: t,
                            order: n,
                            ...this._getPaging(a, s, o),
                            omitTotalCount: l,
                            options: this._optionsWithPlugins(i)
                        }).then((({
                            items: e,
                            pagingMetadata: t
                        }) => ({
                            items: e,
                            totalCount: t.total,
                            pagingMetadata: t
                        })))))
                    }))
                }
                insertReference(e, t, r, i, n) {
                    return this._traceWith("platformized-provider-insert-reference", {
                        collectionName: e
                    })((() => this.insertReferences(e, [{
                        relationshipName: t,
                        left: r,
                        right: i
                    }], n)))
                }
                insertReferences(e, t, r) {
                    return this._traceWith("platformized-provider-insert-references", {
                        collectionName: e
                    })((() => N().collectionName(e).options(r).validateAndReject().then((() => this.shouldUseDataItemService)).then((i => {
                        if (i) {
                            const i = t.map((({
                                relationshipName: e,
                                left: t,
                                right: r
                            }) => ({
                                referringItemFieldName: e,
                                referringItemId: t,
                                referencedItemId: r
                            })));
                            return this._call("/v2/bulk/items/insert-references", {
                                dataCollectionId: e,
                                dataItemReferences: i,
                                options: this._optionsWithPluginsItemService(r)
                            }, !1, !0)
                        }
                        return this._call("/v1/wix-data/collections/bulk-insert-references", {
                            collectionName: e,
                            references: t.map((({
                                relationshipName: e,
                                left: t,
                                right: r
                            }) => ({
                                propertyName: e,
                                referringItemId: t,
                                referencedItemId: r
                            }))),
                            options: this._optionsWithPlugins(r)
                        })
                    }))))
                }
                replaceReferences(e, t, r, i) {
                    return this._traceWith("platformized-provider-replace-references", {
                        collectionName: e
                    })((() => N().collectionName(e).options(i).validateAndReject().then((() => this.shouldUseDataItemService)).then((n => n ? this._call("/v2/items/replace-references", {
                        dataCollectionId: e,
                        referringItemFieldName: t.relationshipName,
                        referringItemId: t.left,
                        newReferencedItemIds: r.map((({
                            right: e
                        }) => e)),
                        options: this._optionsWithPluginsItemService(i)
                    }, !1, !0) : this._call("/v1/wix-data/collections/bulk-replace-references", {
                        collectionName: e,
                        propertyName: t.relationshipName,
                        referringItemId: t.left,
                        newReferencedItemIds: r.map((({
                            right: e
                        }) => e)),
                        options: this._optionsWithPlugins(i)
                    })))))
                }
                removeReference(e, t, r, i, n) {
                    return this._traceWith("platformized-provider-remove-reference", {
                        collectionName: e
                    })((() => this.removeReferences(e, [{
                        relationshipName: t,
                        left: r,
                        right: i
                    }], n)))
                }
                removeReferences(e, t, r) {
                    return this._traceWith("platformized-provider-remove-references", {
                        collectionName: e
                    })((() => N().collectionName(e).options(r).validateAndReject().then((() => this.shouldUseDataItemService)).then((i => i ? this._call("/v2/bulk/items/remove-references", {
                        dataCollectionId: e,
                        dataItemReferences: t.map((({
                            relationshipName: e,
                            left: t,
                            right: r
                        }) => ({
                            referringItemFieldName: e,
                            referringItemId: t,
                            referencedItemId: r
                        }))),
                        options: this._optionsWithPluginsItemService(r)
                    }, !1, !0) : this._call("/v1/wix-data/collections/bulk-remove-references", {
                        collectionName: e,
                        references: t.map((({
                            relationshipName: e,
                            left: t,
                            right: r
                        }) => ({
                            propertyName: e,
                            referringItemId: t,
                            referencedItemId: r
                        }))),
                        options: this._optionsWithPlugins(r)
                    })))))
                }
                isReferenced(e, t, r, i, n) {
                    return this._traceWith("platformized-provider-is-referenced", {
                        collectionName: e
                    })((() => N().collectionName(e).options(n).validateAndReject().then((() => this.shouldUseDataItemService)).then((s => s ? this._call("/v2/items/is-referenced", {
                        dataCollectionId: e,
                        referringItemFieldName: t,
                        referringItemId: r,
                        referencedItemId: i,
                        options: this._optionsWithPluginsItemService(n)
                    }, !1, !0) : this._call("/v1/wix-data/collections/is-referenced", {
                        collectionName: e,
                        propertyName: t,
                        referringItemId: r,
                        referencedItemId: i,
                        options: this._optionsWithPlugins(n)
                    }))).then((({
                        isReferenced: e
                    }) => e))))
                }
                _mapOrderToSort(e) {
                    return e.flatMap((e => Object.entries(e).map((([e, t]) => ({
                        fieldName: e,
                        order: t.toUpperCase()
                    })))))
                }
                _validateOrderBy(e, t) {
                    const r = e => l.orderByValidations.sortModelType(e);
                    if ([null, void 0].includes(t)) return Promise.resolve();
                    if (n = t, !(0, i.isArray)(n)) return Promise.reject(this._validationError(e, [r(t)]));
                    var n;
                    const s = t.flatMap((e => (e => !(0, i.isObject)(e))(e) ? (e => l.orderByValidations.sortModelItemType(e))(e) : (e => {
                        const t = Object.values(e);
                        return !(1 === t.length && ("asc" === t[0] || "desc" === t[0]))
                    })(e) ? (e => l.orderByValidations.sortModelItem(e))(e) : []));
                    return s.length ? Promise.reject(this._validationError(e, s)) : Promise.resolve()
                }
                _validateFilter(e, t) {
                    const r = l.filterTreeValidations.objectType,
                        n = l.filterTreeValidations.arrayType,
                        s = l.filterTreeValidations.arrayLength,
                        a = l.filterTreeValidations.comparisonOperatorType,
                        o = l.filterTreeValidations.stringOperatorType,
                        u = l.filterTreeValidations.setOperatorItems,
                        c = l.filterTreeValidations.inOperatorItems,
                        d = l.filterTreeValidations.matchesOperatorRequiredProperty,
                        h = l.filterTreeValidations.matchesOperatorIgnoreCase,
                        p = l.filterTreeValidations.matchesOperatorSpecItems,
                        m = l.filterTreeValidations.regexNotAllowed,
                        g = (e, t) => void 0 === t || (0, i.isObject)(t) ? [] : [r(e, t)],
                        f = (e, t) => (0, i.isArray)(t) ? t.flatMap((t => g(e, t))) : [],
                        v = (e, t) => void 0 === t || (0, i.isArray)(t) ? [] : [n(e, t)],
                        y = (e, t) => void 0 === t || (0, i.isString)(t) || (0, i.isNumber)(t) || (0, i.isDate)(t) ? [] : [a(e, t)],
                        N = (e, t) => void 0 === t || (0, i.isString)(t) ? [] : [o(e, t)],
                        _ = (e, t) => (0, i.isArray)(t) ? t.every((e => (0, i.isDate)(e) || (0, i.isString)(e) || (0, i.isNumber)(e))) ? [] : [u(e, t)] : [],
                        I = (e, t, r) => (0, i.isArray)(t) ? t.length === r ? [] : [s(e, r, t)] : [],
                        b = e => {
                            if (!(0, i.isObject)(e)) return [];
                            if (void 0 === e.ignoreCase) return [d("ignoreCase", e)];
                            if (!0 !== e.ignoreCase) return [h(e.ignoreCase)];
                            if (void 0 === e.spec) return [d("spec", e)];
                            if (!(0, i.isArray)(e.spec)) return [n("$matches.spec", e.spec)];
                            const t = e.spec.find((e => !(e => !!(0, i.isObject)(e) && ("anyOf" === e.type && " \t\n-" === e.value || !("literal" !== e.type || !(0, i.isString)(e.value))))(e)));
                            return void 0 !== t ? [p(t)] : []
                        },
                        A = e => {
                            if (!(0, i.isObject)(e)) return [];
                            const {
                                $and: t,
                                $or: r,
                                $not: n,
                                $gt: s,
                                $gte: a,
                                $lt: o,
                                $lte: l,
                                $startsWith: u,
                                $endsWith: d,
                                $contains: h,
                                $hasSome: p,
                                $hasAll: S,
                                $in: O,
                                $matches: $,
                                $regex: j,
                                ...D
                            } = e;
                            let E = [].concat(v("$and", t)).concat(f("Filter Model", t)).concat(v("$or", r)).concat(f("Filter Model", r)).concat(v("$not", n)).concat(f("Filter Model", n)).concat(v("$hasSome", p)).concat(v("$hasAll", S)).concat(v("$in", O)).concat(_("$hasSome", p)).concat(_("$hasAll", S)).concat(y("$gt", s)).concat(y("$gte", a)).concat(y("$lt", o)).concat(y("$lte", l)).concat(N("$startsWith", u)).concat(N("$endsWith", d)).concat(N("$contains", h)).concat(I("$not", n, 1)).concat(I("$in", O, 2)).concat((w = O, (0, i.isArray)(w) ? 2 !== w.length || (0, i.isString)(w[0]) && (0, i.isNumber)(w[1]) ? [] : [c(w)] : [])).concat(g("$matches", $)).concat(b($)).concat((e => void 0 === e ? [] : [m()])(j));
                            var w;
                            return E.length ? E : (E = [].concat(t ? t.flatMap(A) : []).concat(r ? r.flatMap(A) : []).concat(n ? n.flatMap(A) : []), E.length ? E : Object.values(D).flatMap(A))
                        };
                    if ([null, void 0].includes(t)) return Promise.resolve();
                    if (!(0, i.isObject)(t)) return Promise.reject(this._validationError(e, [r("Filter Model", t)]));
                    const S = A(t);
                    return S.length ? Promise.reject(this._validationError(e, S)) : Promise.resolve()
                }
                _validationError(e, t) {
                    return d(l.queryValidations.queryInvalid(e, t))
                }
                _getAuthHeader() {
                    return Promise.resolve(ke(this.authHeader) ? this.authHeader.get() : this.authHeader)
                }
                _call(e, t, r = !1, n = !1) {
                    return Promise.all([this._getGridAppId(), this._getAuthHeader()]).then((([s, a]) => this.traceWith("wix-data-api-call", {
                        url: `${this.cloudDataUrl}${e}`,
                        options: JSON.stringify(t.options)
                    })((() => {
                        const o = n ? (0, i.serializeDates)(Object.assign(t, {
                                environment: this.segment.toUpperCase(),
                                appId: s
                            })) : (0, i.serializeDates)(Object.assign(t, {
                                segment: this.segment.toUpperCase(),
                                appId: s
                            })),
                            l = a ? {
                                authorization: a
                            } : {};
                        if (r && this.allowGetRequests) {
                            const r = `${this.cloudDataUrl}${e}?.r=${(0,i.base64url)(o)}`;
                            if (r.length <= 2048) return this.httpClientProvider(t.options).get(r, {
                                headers: l
                            }).catch(Ee(this.traceWith)).then(De(this.traceWith))
                        }
                        return this.httpClientProvider(t.options).post(`${this.cloudDataUrl}${e}`, o, {
                            headers: l
                        }).catch(Ee(this.traceWith)).then(De(this.traceWith))
                    }))))
                }
                _getGridAppId() {
                    return Promise.resolve(ke(this.gridAppId) ? this.gridAppId.get() : this.gridAppId)
                }
                _traceWith(e, t) {
                    return r => this._getGridAppId().then((i => this.traceWith(e, {
                        gridAppId: i,
                        segment: this.segment,
                        ...t
                    })(r)))
                }
            }
            const Ve = () => e => e();

            function Fe({
                cloudDataUrl: e = "/_api/cloud-data",
                gridAppId: t,
                segment: r,
                httpClient: i,
                authHeader: n,
                traceWith: s = Ve,
                allowGetRequests: a = !1,
                shouldUseDataItemService: o = Promise.resolve(!1)
            }) {
                return new ve(new Re({
                    cloudDataUrl: e,
                    gridAppId: t,
                    segment: r,
                    httpClient: i,
                    authHeader: n,
                    traceWith: s,
                    allowGetRequests: a,
                    shouldUseDataItemService: o
                }))
            }
            const Be = "data";

            function qe({
                featureConfig: e,
                platformUtils: t,
                appEssentials: r,
                platformEnvData: {
                    site: i
                }
            }) {
                const n = {
                        get() {
                            return t.sessionService.getWixCodeInstance()
                        }
                    },
                    s = Boolean(i.experiments["specs.thunderbolt.UseWixDataItemService"]),
                    a = Boolean(i.experiments["specs.thunderbolt.UseWixDataGetRequests"]),
                    {
                        gridAppId: o,
                        segment: l,
                        cloudDataUrl: u
                    } = e,
                    {
                        httpClient: c
                    } = r;
                return {
                    [Be]: Fe({
                        cloudDataUrl: u,
                        httpClient: c,
                        gridAppId: o,
                        segment: l,
                        authHeader: n,
                        shouldUseDataItemService: Promise.resolve(s),
                        allowGetRequests: a
                    })
                }
            }
        }
    }
]);
//# sourceMappingURL=feature-data-wix-code-sdk.d4e23ef8.chunk.min.js.map